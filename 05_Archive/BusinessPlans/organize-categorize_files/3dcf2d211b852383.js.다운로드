(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,752591,e=>{"use strict";e.s(["default",()=>t]);let t=(0,e.i(510965).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},737219,(e,t,r)=>{t.exports={trueFunc:function(){return!0},falseFunc:function(){return!1}}},506327,279236,589955,820380,e=>{"use strict";e.s(["select",()=>eb,"selectAll",()=>ew],506327);var t,r=e.i(61634),n={},o={};function a(e){if(0===e.length)return n;for(var t={},r=0;r<e.length;r++)!function(e,t){for(var r=t,n=0;n<e.length;n++){var o=n===e.length-1,a=e.charAt(n),i=r[a]||(r[a]={chars:{}});o&&(i.self=e),r=i.chars}}(e[r],t);return t}var i={},l={type:"String",optional:!0};function s(e){for(var t=function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],a=e[o];if(a)for(var i=0;i<a.length;i++){var l=a[i];(t[l]||(t[l]=[])).push(o)}}return t}(e),r={},n=0,o=Object.keys(t);n<o.length;n++){var a=o[n],i=t[a];i&&(r[a]=function(e){var t={type:"NoArgument",optional:!1};function r(e){if(t.type&&t.type!==e&&"NoArgument"!==t.type)throw Error('Conflicting pseudo-class argument type: "'.concat(t.type,'" vs "').concat(e,'".'));t.type=e}for(var n=0;n<e.length;n++){var o=e[n];"NoArgument"===o&&(t.optional=!0),"Formula"===o&&r("Formula"),"FormulaOfSelector"===o&&(r("Formula"),t.ofSelector=!0),"String"===o&&r("String"),"Selector"===o&&r("Selector")}return t}(i))}return r}var c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u={},d={wildcard:!0};function f(e,t){return function(r,n){return!0===n?e:t(!0===r?e:r,n)}}function p(e){return function(t,r){if(!r||!t)return r;if("object"!=typeof r||null===r)throw Error("Unexpected syntax definition extension type: ".concat(r,"."));for(var n=c({},t),o=0,a=Object.entries(r);o<a.length;o++){var i=a[o],l=i[0],s=i[1];if("latest"!==l){var u=e[l];n[l]=u(t[l],s)}}return n}}function h(e,t){return void 0!==t?t:e}function m(e,t){return t?e?e.concat(t):t:e}function g(e,t){if(!t)return e;if(!e)return t;for(var r=c({},e),n=0,o=Object.entries(t);n<o.length;n++){var a=o[n],i=a[0],l=a[1];if(!l){delete r[i];continue}var s=e[i];if(!s){r[i]=l;continue}r[i]=s.concat(l)}return r}var O=(t=p({baseSyntax:h,modules:m,tag:f(d,p({wildcard:h})),ids:h,classNames:h,namespace:f(d,p({wildcard:h})),combinators:m,attributes:p({operators:m,caseSensitivityModifiers:m,unknownCaseSensitivityModifiers:h}),pseudoClasses:p({unknown:h,definitions:g}),pseudoElements:p({unknown:h,notation:h,definitions:function(e,t){return function(r,n){return t(e(r),e(n))}}(function(e){return Array.isArray(e)?{NoArgument:e}:e},g)})}),function(e,r){var n=t(e,r);if(!n)throw Error("Syntax definition cannot be null or undefined.");return n}),v={tag:{},ids:!0,classNames:!0,combinators:[],pseudoElements:{unknown:"reject",notation:"singleColon",definitions:["first-letter","first-line"]},pseudoClasses:{unknown:"reject",definitions:{NoArgument:["link","visited","active"]}}},S=O(v,{tag:{wildcard:!0},combinators:[">","+"],attributes:{unknownCaseSensitivityModifiers:"reject",operators:["=","~=","|="]},pseudoElements:{definitions:["before","after"]},pseudoClasses:{unknown:"reject",definitions:{NoArgument:["hover","focus","first-child"],String:["lang"]}}}),y=O(S,{namespace:{wildcard:!0},combinators:["~"],attributes:{operators:["^=","$=","*="]},pseudoElements:{notation:"both"},pseudoClasses:{definitions:{NoArgument:["root","last-child","first-of-type","last-of-type","only-child","only-of-type","empty","target","enabled","disabled","checked","indeterminate"],Formula:["nth-child","nth-last-child","nth-of-type","nth-last-of-type"],Selector:["not"]}}}),b=O(y,{combinators:["||"],attributes:{caseSensitivityModifiers:["i","I","s","S"]},pseudoClasses:{definitions:{NoArgument:["any-link","local-link","target-within","scope","current","past","future","focus-within","focus-visible","read-write","read-only","placeholder-shown","default","valid","invalid","in-range","out-of-range","required","optional","blank","user-invalid","playing","paused","autofill","modal","fullscreen","picture-in-picture","defined","loading","popover-open"],Formula:["nth-col","nth-last-col"],String:["dir"],FormulaOfSelector:["nth-child","nth-last-child"],Selector:["current","is","where","has","state"]}},pseudoElements:{definitions:{NoArgument:["marker"],Selector:["part"]}}}),w={"css-position-1":{latest:!1,pseudoClasses:{definitions:{NoArgument:["static","relative","absolute"]}}},"css-position-2":{latest:!1,pseudoClasses:{definitions:{NoArgument:["static","relative","absolute","fixed"]}}},"css-position-3":{latest:!1,pseudoClasses:{definitions:{NoArgument:["sticky","fixed","absolute","relative","static"]}}},"css-position-4":{latest:!0,pseudoClasses:{definitions:{NoArgument:["sticky","fixed","absolute","relative","static","initial"]}}},"css-scoping-1":{latest:!0,pseudoClasses:{definitions:{NoArgument:["host","host-context"],Selector:["host","host-context"]}},pseudoElements:{definitions:{Selector:["slotted"]}}},"css-pseudo-4":{latest:!0,pseudoElements:{definitions:{NoArgument:["marker","selection","target-text","search-text","spelling-error","grammar-error","backdrop","file-selector-button","prefix","postfix","placeholder","details-content"],String:["highlight"]}}},"css-shadow-parts-1":{latest:!0,pseudoElements:{definitions:{Selector:["part"]}}}},x=c(c({},b),{modules:Object.entries(w).filter(function(e){return e[1].latest}).map(function(e){return e[0]})}),E=O(x,{pseudoElements:{unknown:"accept"},pseudoClasses:{unknown:"accept"},attributes:{unknownCaseSensitivityModifiers:"accept"}}),C={css1:v,css2:S,css3:y,"selectors-3":y,"selectors-4":b,latest:x,progressive:E},P=function(){for(var e={pseudoClasses:{},pseudoElements:{}},t=0,r=["css1","css2","css3","selectors-3","selectors-4"];t<r.length;t++){var n=r[t],o=C[n];if(o.pseudoClasses&&"object"==typeof o.pseudoClasses){var a=o.pseudoClasses.definitions;if(a)for(var i=0,l=Object.entries(a);i<l.length;i++)for(var s=l[i][1],c=0,u=s;c<u.length;c++){var d=u[c];e.pseudoClasses[d]||(e.pseudoClasses[d]=[]),e.pseudoClasses[d].includes(n)||e.pseudoClasses[d].push(n)}}if(o.pseudoElements&&"object"==typeof o.pseudoElements){var a=o.pseudoElements.definitions;if(a)if(Array.isArray(a))for(var f=0,p=a;f<p.length;f++){var h=p[f];e.pseudoElements[h]||(e.pseudoElements[h]=[]),e.pseudoElements[h].includes(n)||e.pseudoElements[h].push(n)}else for(var m=0,g=Object.values(a);m<g.length;m++)for(var s=g[m],O=0,v=s;O<v.length;O++){var S=v[O];e.pseudoElements[S]||(e.pseudoElements[S]=[]),e.pseudoElements[S].includes(n)||e.pseudoElements[S].push(n)}}}for(var y=0,b=Object.entries(w);y<b.length;y++){var x=b[y],E=x[0],P=x[1];if(P.pseudoClasses&&"object"==typeof P.pseudoClasses){var a=P.pseudoClasses.definitions;if(a)for(var k=0,Q=Object.values(a);k<Q.length;k++)for(var s=Q[k],R=0,A=s;R<A.length;R++){var T=A[R];e.pseudoClasses[T]||(e.pseudoClasses[T]=[]),e.pseudoClasses[T].includes(E)||e.pseudoClasses[T].push(E)}}if(P.pseudoElements&&"object"==typeof P.pseudoElements){var a=P.pseudoElements.definitions;if(a)if(Array.isArray(a))for(var N=0,W=a;N<W.length;N++){var q=W[N];e.pseudoElements[q]||(e.pseudoElements[q]=[]),e.pseudoElements[q].includes(E)||e.pseudoElements[q].push(E)}else for(var I=0,M=Object.values(a);I<M.length;I++)for(var s=M[I],X=0,D=s;X<D.length;X++){var j=D[X];e.pseudoElements[j]||(e.pseudoElements[j]=[]),e.pseudoElements[j].includes(E)||e.pseudoElements[j].push(E)}}}return e}();function k(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||"-"===e||"_"===e||"\\"===e||e>=" "}function Q(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"-"===e||"_"===e||e>=" "}function R(e){return e>="a"&&e<="f"||e>="A"&&e<="F"||e>="0"&&e<="9"}var A={" ":!0,"	":!0,"\n":!0,"\r":!0,"\f":!0},T={'"':!0,"'":!0},N={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0},W="css-selector-parser parse error: ",q=function(){return(q=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function I(e){return function(t,r){var n;return(n={})[t]=function(t){return q({type:e},t)},n[r]=function(t){return"object"==typeof t&&null!==t&&t.type===e},n}}q(q(q(q(q(q(q(q(q(q(q(q(q(q(q(q({},I("Selector")("selector","isSelector")),I("Rule")("rule","isRule")),I("TagName")("tagName","isTagName")),I("Id")("id","isId")),I("ClassName")("className","isClassName")),I("WildcardTag")("wildcardTag","isWildcardTag")),I("NamespaceName")("namespaceName","isNamespaceName")),I("WildcardNamespace")("wildcardNamespace","isWildcardNamespace")),I("NoNamespace")("noNamespace","isNoNamespace")),I("Attribute")("attribute","isAttribute")),I("PseudoClass")("pseudoClass","isPseudoClass")),I("PseudoElement")("pseudoElement","isPseudoElement")),I("String")("string","isString")),I("Formula")("formula","isFormula")),I("FormulaOfSelector")("formulaOfSelector","isFormulaOfSelector")),I("Substitution")("substitution","isSubstitution"));let M=function(e){void 0===e&&(e={});var t,r=e.syntax,c=void 0===r?"latest":r,f=e.substitutes,p=e.strict,h=void 0===p||p,m=e.modules,g="object"==typeof c?c:C[c];if(g.baseSyntax&&(g=O(C[g.baseSyntax],g)),g.modules&&g.modules.length>0)for(var v=0,S=g.modules;v<S.length;v++){var y=w[S[v]];y&&(g=O(y,g))}if(m&&m.length>0)for(var b=0;b<m.length;b++){var y=w[m[b]];y&&(g=O(y,g))}var x=g.tag?[!0,!!(!(t=g.tag)?u:"boolean"==typeof t?d:t).wildcard]:[!1,!1],E=x[0],q=x[1],I=!!g.ids,M=!!g.classNames,X=!!g.namespace,D=g.namespace&&(!0===g.namespace||!0===g.namespace.wildcard);if(X&&!E)throw Error("".concat(W,"Namespaces cannot be enabled while tags are disabled."));var j=!!f,B=g.combinators?a(g.combinators):n,z=g.attributes?[!0,g.attributes.operators?a(g.attributes.operators):n,g.attributes.caseSensitivityModifiers?function(e){if(0===e.length)return o;for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}(g.attributes.caseSensitivityModifiers):o,"accept"===g.attributes.unknownCaseSensitivityModifiers]:[!1,n,o,!1],_=z[0],V=z[1],F=z[2],L=z[3],U=L||Object.keys(F).length>0,G=g.pseudoClasses?[!0,g.pseudoClasses.definitions?s(g.pseudoClasses.definitions):i,"accept"===g.pseudoClasses.unknown]:[!1,i,!1],Y=G[0],Z=G[1],$=G[2],H=g.pseudoElements?[!0,"singleColon"===g.pseudoElements.notation||"both"===g.pseudoElements.notation,!g.pseudoElements.notation||"doubleColon"===g.pseudoElements.notation||"both"===g.pseudoElements.notation,g.pseudoElements.definitions?s(Array.isArray(g.pseudoElements.definitions)?{NoArgument:g.pseudoElements.definitions}:g.pseudoElements.definitions):i,"accept"===g.pseudoElements.unknown]:[!1,!1,!1,i,!1],J=H[0],K=H[1],ee=H[2],et=H[3],er=H[4],en="",eo=en.length,ea=0,ei="",el=function(e){return ei===e},es=function(){return el("*")||k(ei)},ec=function(e){ea=e,ei=en.charAt(ea)},eu=function(){ea++,ei=en.charAt(ea)},ed=function(){var e=ei;return ea++,ei=en.charAt(ea),e};function ef(e){var t=Math.min(eo-1,ea),r=Error("".concat(W).concat(e," Pos: ").concat(t,"."));throw r.position=t,r.name="ParserError",r}function ep(e,t){if(!e)return ef(t)}var eh=function(){ep(ea<eo,"Unexpected end of input.")},em=function(){return ea>=eo},eg=function(e){ep(ea<eo,'Expected "'.concat(e,'" but end of input reached.')),ep(ei===e,'Expected "'.concat(e,'" but "').concat(ei,'" found.')),ea++,ei=en.charAt(ea)};function eO(e){var t=function e(t,r){var n=t[en.charAt(r)];if(n){var o=e(n.chars,r+1);if(o)return o;if(n.self)return n.self}}(e,ea);if(t)return ea+=t.length,ei=en.charAt(ea),t}function ev(){for(var e=ed(),t=1;R(ei)&&t<6;)e+=ed(),t++;return function(){if(" "===ei||"	"===ei||"\f"===ei||"\n"===ei)return eu();"\r"===ei&&eu(),"\n"===ei&&eu()}(),String.fromCharCode(parseInt(e,16))}function eS(){if(!k(ei))return null;for(var e="";el("-");)e+=ei,eu();for("-"!==e||Q(ei)||el("\\")||ef("Identifiers cannot consist of a single hyphen."),h&&e.length>=2&&ef("Identifiers cannot start with two hyphens with strict mode on."),N[ei]&&ef("Identifiers cannot start with hyphens followed by digits.");ea<eo;)if(Q(ei))e+=ed();else if(el("\\"))eu(),eh(),R(ei)?e+=ev():e+=ed();else break;return e}function ey(){for(;A[ei];)eu()}function eb(e){void 0===e&&(e=!1),ey();for(var t=[eP(e)];el(",");)eu(),ey(),t.push(eP(e));return{type:"Selector",rules:t}}function ew(){for(var e="";N[ei];)e+=ed();return ep(""!==e,"Formula parse error."),parseInt(e)}function ex(e,t,r){var n;if(el("(")){if(eu(),ey(),j&&el("$")){eu();var o=eS();ep(o,"Expected substitute name."),n={type:"Substitution",name:o}}else if("String"===r.type)ep((n={type:"String",value:function(){for(var e="";ea<eo;)if(el(")"))break;else if(el("\\")){if(eu(),em()&&!h)return(e+"\\").trim();eh(),R(ei)?e+=ev():e+=ed()}else e+=ed();return e.trim()}()}).value,"Expected ".concat(t," argument value."));else if("Selector"===r.type)n=eb(!0);else{if("Formula"!==r.type)return ef("Invalid ".concat(t," signature."));var a=function(){if(el("e")||el("o")){var e,t=eS();if("even"===t)return ey(),[2,0];if("odd"===t)return ey(),[2,1]}var r=null,n=1;if(el("-")&&(eu(),n=-1),(el("-")||el("+")||N[ei])&&(el("+")&&eu(),r=ew(),!el("\\")&&!el("n")))return[0,r*n];if(null===r&&(r=1),r*=n,el("\\")?(eu(),e=R(ei)?ev():ed()):e=ed(),ep("n"===e,'Formula parse error: expected "n".'),ey(),!(el("+")||el("-")))return[r,0];var o=el("+")?1:-1;return eu(),ey(),[r,o*ew()]}(),i=a[0],l=a[1];n={type:"Formula",a:i,b:l},r.ofSelector&&(ey(),(el("o")||el("\\"))&&(ep("of"===eS(),"Formula of selector parse error."),ey(),n={type:"FormulaOfSelector",a:i,b:l,selector:eP()}))}if(ey(),em()&&!h)return n;eg(")")}else ep(r.optional,"Argument is required for ".concat(t,' "').concat(e,'".'));return n}function eE(){if(el("*"))return ep(q,"Wildcard tag name is not enabled."),eu(),{type:"WildcardTag"};if(!k(ei))return ef("Expected tag name.");ep(E,"Tag names are not enabled.");var e=eS();return ep(e,"Expected tag name."),{type:"TagName",name:e}}function eC(){if(el("*")){var e=ea;if(eu(),!el("|")||(eu(),!es()))return ec(e),eE();ep(X,"Namespaces are not enabled."),ep(D,"Wildcard namespace is not enabled.");var t=eE();return t.namespace={type:"WildcardNamespace"},t}if(el("|")){ep(X,"Namespaces are not enabled."),eu();var t=eE();return t.namespace={type:"NoNamespace"},t}if(!k(ei))return ef("Expected tag name.");var r=eS();if(ep(r,"Expected tag name."),!el("|"))return ep(E,"Tag names are not enabled."),{type:"TagName",name:r};var e=ea;if(eu(),!es())return ec(e),{type:"TagName",name:r};ep(X,"Namespaces are not enabled.");var t=eE();return t.namespace={type:"NamespaceName",name:r},t}function eP(e){void 0===e&&(e=!1);var t,r,n={type:"Rule",items:[]};if(e){var o=eO(B);o&&(n.combinator=o,ey())}for(;ea<eo;)if(es())ep(0===n.items.length,"Unexpected tag/namespace start."),n.items.push(eC());else if(el("|")){var a=ea;if(eu(),es())ep(0===n.items.length,"Unexpected tag/namespace start."),ec(a),n.items.push(eC());else{ec(a);break}}else if(el(".")){ep(M,"Class names are not enabled."),eu();var i=eS();ep(i,"Expected class name."),n.items.push({type:"ClassName",name:i})}else if(el("#")){ep(I,"IDs are not enabled."),eu();var s=eS();ep(s,"Expected ID name."),n.items.push({type:"Id",name:s})}else if(el("["))ep(_,"Attributes are not enabled."),n.items.push(function(){if(eg("["),ey(),el("|")){ep(X,"Namespaces are not enabled."),eu();var e,t=eS();ep(t,"Expected attribute name."),e={type:"Attribute",name:t,namespace:{type:"NoNamespace"}}}else if(el("*")){ep(X,"Namespaces are not enabled."),ep(D,"Wildcard namespace is not enabled."),eu(),eg("|");var r=eS();ep(r,"Expected attribute name."),e={type:"Attribute",name:r,namespace:{type:"WildcardNamespace"}}}else{var n=eS();if(ep(n,"Expected attribute name."),e={type:"Attribute",name:n},el("|")){var o=ea;if(eu(),k(ei)){ep(X,"Namespaces are not enabled.");var a=eS();ep(a,"Expected attribute name."),e={type:"Attribute",name:a,namespace:{type:"NamespaceName",name:n}}}else ec(o)}}if(ep(e.name,"Expected attribute name."),ey(),em()&&!h)return e;if(el("]"))eu();else{if(e.operator=eO(V),ep(e.operator,"Expected a valid attribute selector operator."),ey(),eh(),T[ei])e.value={type:"String",value:function(e){var t="";for(eg(e);ea<eo;)if(el(e)){eu();break}else el("\\")?(eu(),el(e)?(t+=e,eu()):"\n"===ei||"\f"===ei?eu():"\r"===ei?(eu(),el("\n")&&eu()):R(ei)?t+=ev():(t+=ei,eu())):(t+=ei,eu());return t}(ei)};else if(j&&el("$")){eu();var i=eS();ep(i,"Expected substitute name."),e.value={type:"Substitution",name:i}}else{var l=eS();ep(l,"Expected attribute value."),e.value={type:"String",value:l}}if(ey(),em()&&!h)return e;if(!el("]")){var s=eS();if(ep(s,"Expected end of attribute selector."),e.caseSensitivityModifier=s,ep(U,"Attribute case sensitivity modifiers are not enabled."),ep(L||F[e.caseSensitivityModifier],"Unknown attribute case sensitivity modifier."),ey(),em()&&!h)return e}eg("]")}return e}());else if(el(":")){var c=!1;eu(),el(":")&&(ep(J,"Pseudo elements are not enabled."),ep(ee,"Pseudo elements double colon notation is not enabled."),c=!0,eu());var u=eS();if(ep(c||u,"Expected pseudo-class name."),ep(!c||u,"Expected pseudo-element name."),ep(u,"Expected pseudo-class name."),!c||er||Object.prototype.hasOwnProperty.call(et,u));else{var d=P.pseudoElements[u],f='Unknown pseudo-element "'.concat(u,'"');d&&d.length>0&&(f+=". It is defined in: ".concat(d.join(", "))),ef(f+".")}if(J&&(c||!c&&K&&Object.prototype.hasOwnProperty.call(et,u))){var p=null!=(t=et[u])?t:er&&l,m={type:"PseudoElement",name:u},g=ex(u,"pseudo-element",p);g&&(ep("Formula"!==g.type&&"FormulaOfSelector"!==g.type,"Pseudo-elements cannot have formula argument."),m.argument=g),n.items.push(m)}else{ep(Y,"Pseudo-classes are not enabled.");var p=null!=(r=Z[u])?r:$&&l;if(p);else{var d=P.pseudoClasses[u],f='Unknown pseudo-class: "'.concat(u,'"');d&&d.length>0&&(f+=". It is defined in: ".concat(d.join(", "))),ef(f+".")}var g=ex(u,"pseudo-class",p),O={type:"PseudoClass",name:u};g&&(O.argument=g),n.items.push(O)}}else break;if(0===n.items.length)if(em())return ef("Expected rule but end of input reached.");else return ef('Expected rule but "'.concat(ei,'" found.'));if(ey(),!em()&&!el(",")&&!el(")")){var o=eO(B);ey(),n.nestedRule=eP(),n.nestedRule.combinator=o}return n}return function(e){if("string"!=typeof e)throw Error("".concat(W,"Expected string input."));return eo=(en=e).length,ea=0,ei=en.charAt(0),eb()}}({syntax:"selectors-4"}),X="֑-߿יִ-﷽ﹰ-ﻼ",D="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",j=RegExp("^[^"+D+"]*["+X+"]"),B=RegExp("^[^"+X+"]*["+D+"]");function z(e){return"children"in e?function e(t){let r=-1,n=[];for(;++r<t.children.length;){var o;n[r]="text"===(o=t.children[r]).type?o.value:"children"in o?e(o):""}return n.join("")}(e):"value"in e?e.value:""}e.s(["toString",()=>z],279236);var _=e.i(939049),V=e.i(446207);function F(e){let t=function(e){let t=String(e||"");return j.test(t)?"rtl":B.test(t)?"ltr":"neutral"}(e);return"neutral"===t?void 0:t}function L(e){let t="element"===e.type&&"string"==typeof e.properties.dir?e.properties.dir.toLowerCase():void 0;return"auto"===t||"ltr"===t||"rtl"===t?t:void 0}var U=e.i(816220),G=e.i(897802),Y=e.i(273638),Z=e.i(722365);let $=[];function H(e,t){return function(r,n){let o=K(r,"tag"),a=K(null==n?"*":n,"range"),i=[],l=-1;for(;++l<a.length;){let r=a[l].toLowerCase();if(!t&&"*"===r)continue;let n=-1,s=[];for(;++n<o.length;)if(e(o[n].toLowerCase(),r)){if(!t)return o[n];i.push(o[n])}else s.push(o[n]);o=s}return t?i:void 0}}H(function(e,t){return"*"===t||e===t||e.includes(t+"-")},!0);let J=H(function(e,t){let r=e.split("-"),n=t.split("-"),o=0,a=0;if("*"!==n[0]&&r[o]!==n[a])return!1;for(o++,a++;a<n.length;){if("*"===n[a]){a++;continue}if(!r[o])return!1;if(r[o]===n[a]){o++,a++;continue}if(1===r[o].length)return!1;o++}return!0},!0);function K(e,t){let r=e&&"string"==typeof e?[e]:e;if(!r||"object"!=typeof r||!("length"in r))throw Error("Invalid "+t+" `"+r+"`, expected non-empty string");return r}H(function(e,t){let r=t;for(;;){if("*"===r||e===r)return!0;let t=r.lastIndexOf("-");if(t<0)return!1;"-"===r.charAt(t-2)&&(t-=2),r=r.slice(0,t)}},!1),e.s(["hasProperty",()=>et],589955);let ee={}.hasOwnProperty;function et(e,t){let r="element"===e.type&&ee.call(e.properties,t)&&e.properties[t];return null!=r&&!1!==r}var er=e.i(158206);let en=new Set([9,10,12,13,32]);var eo=e.i(737219);function ea(e){return function(e){let t=e[0],r=e[1]-1;if(r<0&&t<=0)return eo.default.falseFunc;if(-1===t)return e=>e<=r;if(0===t)return e=>e===r;if(1===t)return r<0?eo.default.trueFunc:e=>e>=r;let n=Math.abs(t),o=(r%n+n)%n;return t>1?e=>e>=r&&e%n===o:e=>e<=r&&e%n===o}(function(e){if("even"===(e=e.trim().toLowerCase()))return[2,0];if("odd"===e)return[2,1];let t=0,r=0,n=a(),o=i();if(t<e.length&&"n"===e.charAt(t)&&(t++,r=n*(null!=o?o:1),l(),t<e.length?(n=a(),l(),o=i()):n=o=0),null===o||t<e.length)throw Error("n-th rule couldn't be parsed ('".concat(e,"')"));return[r,n*o];function a(){return"-"===e.charAt(t)?(t++,-1):("+"===e.charAt(t)&&t++,1)}function i(){let r=t,n=0;for(;t<e.length&&e.charCodeAt(t)>=48&&57>=e.charCodeAt(t);)n=10*n+(e.charCodeAt(t)-48),t++;return t===r?null:n}function l(){for(;t<e.length&&en.has(e.charCodeAt(t));)t++}}(e))}var ei=e.i(79694);let el=ea.default||ea,es=(0,ei.zwitch)("name",{handlers:{"any-link":function(e,t){return("a"===t.tagName||"area"===t.tagName||"link"===t.tagName)&&et(t,"href")},blank:function(e,t){return!em(t,function(e){return"element"===e.type||"text"===e.type&&!(0,er.whitespace)(e)})},checked:function(e,t){return"input"===t.tagName||"menuitem"===t.tagName?!!(("checkbox"===t.properties.type||"radio"===t.properties.type)&&et(t,"checked")):"option"===t.tagName&&et(t,"selected")},dir:function(e,t,r,n,o){return(0,G.ok)(e.argument,"expected `argument`"),(0,G.ok)("String"===e.argument.type,"expected plain text"),o.direction===e.argument.value},disabled:eu,empty:function(e,t){return!em(t,function(e){return"element"===e.type||"text"===e.type})},enabled:function(e,t){return!eu(e,t)},"first-child":function(e,t,r,n,o){return ec(o,e),0===o.elementIndex},"first-of-type":function(e,t,r,n,o){return ec(o,e),0===o.typeIndex},has:function(e,t,r,n,o){(0,G.ok)(e.argument,"expected `argument`"),(0,G.ok)("Selector"===e.argument.type,"expected selector");let a={...o,found:!1,one:!0,results:[],rootQuery:e.argument,scopeElements:[t],shallow:!1};return eO(a,{type:"root",children:t.children}),a.results.length>0},is:ef,lang:function(e,t,r,n,o){return(0,G.ok)(e.argument,"expected `argument`"),(0,G.ok)("String"===e.argument.type,"expected string"),""!==o.language&&void 0!==o.language&&J(o.language,(0,U.parse)(e.argument.value)).length>0},"last-child":function(e,t,r,n,o){return ec(o,e),!!(o.elementCount&&o.elementIndex===o.elementCount-1)},"last-of-type":function(e,t,r,n,o){return ec(o,e),"number"==typeof o.typeIndex&&"number"==typeof o.typeCount&&o.typeIndex===o.typeCount-1},not:function(e,t,r,n,o){return!ef(e,t,r,n,o)},"nth-child":function(e,t,r,n,o){let a=ed(e);return ec(o,e),"number"==typeof o.elementIndex&&a(o.elementIndex)},"nth-last-child":function(e,t,r,n,o){let a=ed(e);return ec(o,e),!!("number"==typeof o.elementCount&&"number"==typeof o.elementIndex&&a(o.elementCount-o.elementIndex-1))},"nth-last-of-type":function(e,t,r,n,o){let a=ed(e);return ec(o,e),"number"==typeof o.typeCount&&"number"==typeof o.typeIndex&&a(o.typeCount-1-o.typeIndex)},"nth-of-type":function(e,t,r,n,o){let a=ed(e);return ec(o,e),"number"==typeof o.typeIndex&&a(o.typeIndex)},"only-child":function(e,t,r,n,o){return ec(o,e),1===o.elementCount},"only-of-type":function(e,t,r,n,o){return ec(o,e),1===o.typeCount},optional:function(e,t){return!eh(e,t)},"read-only":function(e,t,r,n,o){return!ep(e,t,r,n,o)},"read-write":ep,required:eh,root:function(e,t,r,n,o){return!!((!n||"root"===n.type)&&o.schema&&("html"===o.schema.space||"svg"===o.schema.space)&&("html"===t.tagName||"svg"===t.tagName))},scope:function(e,t,r,n,o){return o.scopeElements.includes(t)}},invalid:function(){(0,G.unreachable)("Invalid pseudo-selector")},unknown:function(e){throw Error("Unknown pseudo-selector `"+e.name+"`")}});function ec(e,t){if(e.shallow)throw Error("Cannot use `:"+t.name+"` without parent")}function eu(e,t){return("button"===t.tagName||"input"===t.tagName||"select"===t.tagName||"textarea"===t.tagName||"optgroup"===t.tagName||"option"===t.tagName||"menuitem"===t.tagName||"fieldset"===t.tagName)&&et(t,"disabled")}function ed(e){let t=e._cachedFn;if(!t){let r=e.argument;if((0,G.ok)(r,"expected `argument`"),"Formula"!==r.type)throw Error("Expected `nth` formula, such as `even` or `2n+1` (`of` is not yet supported)");e._cachedFn=t=el(r.a+"n+"+r.b)}return t}function ef(e,t,r,n,o){(0,G.ok)(e.argument,"expected `argument`"),(0,G.ok)("Selector"===e.argument.type,"expected selector");let a={...o,found:!1,one:!0,results:[],rootQuery:e.argument,scopeElements:[t],shallow:!1};return eO(a,t),a.results[0]===t}function ep(e,t,r,n,o){return"input"===t.tagName||"textarea"===t.tagName?!et(t,"readOnly")&&!et(t,"disabled"):!!o.editableOrEditingHost}function eh(e,t){return("input"===t.tagName||"textarea"===t.tagName||"select"===t.tagName)&&et(t,"required")}function em(e,t){let r=e.children,n=-1;for(;++n<r.length;)if(t(r[n]))return!0;return!1}let eg=[];function eO(e,t){t&&function e(t,n,o,a,i,l){let s={adjacentSibling:void 0,descendant:void 0,directChild:void 0,generalSibling:void 0},c=function(e,t){let n,o=e.schema,a=e.language,i=e.direction,l=e.editableOrEditingHost;if("element"===t.type){let a=t.properties.xmlLang||t.properties.lang,i=t.properties.type||"text",l=L(t);null!=a&&(e.language=String(a)),o&&"html"===o.space?("true"===t.properties.contentEditable&&(e.editableOrEditingHost=!0),"svg"===t.tagName&&(e.schema=r.svg),"rtl"===l?n=l:"ltr"===l||"auto"!==l&&"html"===t.tagName||"auto"!==l&&"input"===t.tagName&&"tel"===i?n="ltr":("auto"===l||"bdi"===t.tagName)&&("textarea"===t.tagName?n=F(z(t)):"input"===t.tagName&&("email"===i||"search"===i||"tel"===i||"text"===i)?n=t.properties.value?F(String(t.properties.value)):"ltr":(0,V.visit)(t,function(e){return"text"===e.type?(n=F(e.value))?_.EXIT:void 0:e!==t&&"element"===e.type&&("bdi"===e.tagName||"script"===e.tagName||"style"===e.tagName||"textare"===e.tagName||L(e))?_.SKIP:void 0})),n&&(e.direction=n)):e.editableOrEditingHost&&(e.editableOrEditingHost=!1)}return function(){e.schema=o,e.language=a,e.direction=i,e.editableOrEditingHost=l}}(t,o);if("element"===o.type){let e=t.rootQuery.rules;i&&i!==l&&(e=t.rootQuery.rules.filter(e=>void 0===e.combinator||">"===e.combinator&&i===l)),s=function(e,t,r,n,o){let a={adjacentSibling:void 0,descendant:void 0,directChild:void 0,generalSibling:void 0},i=-1;for(;++i<t.length;){let l=t[i];if(e.one&&e.found)break;if(e.shallow&&l.nestedRule)throw Error("Expected selector without nesting");if(function(e,t,r,n,o){for(let a of e.items)if("Attribute"===a.type){if(!function(e,t,r){let n=(0,Y.find)(r,e.name),o=function(e,t){if(null==e);else if("boolean"==typeof e){if(e)return t.attribute}else if(!Array.isArray(e))return String(e);else if(e.length>0)return(t.commaSeparated?U.stringify:Z.stringify)(e)}(t.properties[n.property],n);if(!e.value)return void 0!==o;(0,G.ok)("String"===e.value.type,"expected plain string");let a=e.value.value;if("i"===e.caseSensitivityModifier&&(a=a.toLowerCase(),o&&(o=o.toLowerCase())),void 0!==o)switch(e.operator){case"=":return a===o;case"$=":return a===o.slice(-a.length);case"*=":return o.includes(a);case"^=":return a===o.slice(0,a.length);case"|=":return a===o||a===o.slice(0,a.length)&&"-"===o.charAt(a.length);case"~=":return a===o||Z.parse(o).includes(a)}return!1}(a,t,o.schema))return!1}else if("Id"===a.type){if(t.properties.id!==a.name)return!1}else if("ClassName"===a.type){if(!(t.properties.className||$).includes(a.name))return!1}else if("PseudoClass"===a.type){if(!es(a,t,r,n,o))return!1}else if("PseudoElement"===a.type)throw Error("Invalid selector: `::"+a.name+"`");else if("TagName"===a.type&&a.name!==t.tagName)return!1;return!0}(l,r,n,o,e)){let t=l.nestedRule;t?ev(a,"+"===t.combinator?"adjacentSibling":"~"===t.combinator?"generalSibling":">"===t.combinator?"directChild":"descendant",t):(e.found=!0,e.results.includes(r)||e.results.push(r))}void 0===l.combinator?ev(a,"descendant",l):"~"===l.combinator&&ev(a,"generalSibling",l)}return a}(t,eS(n,e),o,a,i)}return"children"in o&&!t.shallow&&!(t.one&&t.found)&&function(t,r,n,o){let a,i=eS(r.descendant,r.directChild),l=-1,s={count:0,types:new Map},c={count:0,types:new Map};for(;++l<n.children.length;)ey(s,n.children[l]);for(l=-1;++l<n.children.length;){let r=n.children[l],u="element"===r.type?r.tagName.toUpperCase():void 0;if(t.elementIndex=c.count,t.typeIndex=u&&c.types.get(u)||0,t.elementCount=s.count,t.typeCount=u?s.types.get(u):0,"children"in r){let r=e(t,eS(i,a),n.children[l],l,n,o);a=eS(r.generalSibling,r.adjacentSibling)}if(t.one&&t.found)break;ey(c,n.children[l])}}(t,s,o,l),c(),s}(e,[],t,void 0,void 0,t)}function ev(e,t,r){let n=e[t];n?n.push(r):e[t]=[r]}function eS(e,t){return e&&t&&e.length>0&&t.length>0?[...e,...t]:e&&e.length>0?e:t&&t.length>0?t:eg}function ey(e,t){if("element"===t.type){let r=t.tagName.toUpperCase(),n=(e.types.get(r)||0)+1;e.count++,e.types.set(r,n)}}function eb(e,t,r){let n=ex(e,t,r);return n.one=!0,eO(n,t||void 0),n.results[0]}function ew(e,t,r){let n=ex(e,t,r);return eO(n,t||void 0),n.results}function ex(e,t,n){return{direction:"ltr",editableOrEditingHost:!1,elementCount:void 0,elementIndex:void 0,found:!1,language:void 0,one:!1,results:[],rootQuery:function(e){if("string"!=typeof e)throw TypeError("Expected `string` as selector, not `"+e+"`");return M(e)}(e),schema:"svg"===n?r.svg:r.html,scopeElements:t?"root"===t.type?t.children:[t]:[],shallow:!1,typeIndex:void 0,typeCount:void 0}}e.s(["parseSelector",()=>eC],820380);let eE=/[#.]/g;function eC(e,t){let r,n,o=e||"",a={},i=0;for(;i<o.length;){eE.lastIndex=i;let e=eE.exec(o),t=o.slice(i,e?e.index:o.length);t&&(r?"#"===r?a.id=t:Array.isArray(a.className)?a.className.push(t):a.className=[t]:n=t,i+=t.length),e&&(r=e[0],i++)}return{type:"element",tagName:n||t||"div",properties:a,children:[]}}},164877,e=>{"use strict";e.s(["AlertTriangle",()=>t.default]);var t=e.i(752591)},315366,536488,e=>{"use strict";e.s(["ErrorBoundary",()=>l],315366);var t=e.i(486492);e.s(["ErrorBoundary",()=>a,"useErrorBoundary",()=>i],536488);var r=e.i(140578);let n=(0,r.createContext)(null),o={didCatch:!1,error:null};class a extends r.Component{static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){let{error:e}=this.state;if(null!==e){for(var t,r,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];null==(t=(r=this.props).onReset)||t.call(r,{args:a,reason:"imperative-api"}),this.setState(o)}}componentDidCatch(e,t){var r,n;null==(r=(n=this.props).onError)||r.call(n,e,t)}componentDidUpdate(e,t){let{didCatch:r}=this.state,{resetKeys:n}=this.props;if(r&&null!==t.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some((e,r)=>!Object.is(e,t[r]))}(e.resetKeys,n)){var a,i;null==(a=(i=this.props).onReset)||a.call(i,{next:n,prev:e.resetKeys,reason:"keys"}),this.setState(o)}}render(){let{children:e,fallbackRender:t,FallbackComponent:o,fallback:a}=this.props,{didCatch:i,error:l}=this.state,s=e;if(i){let e={error:l,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof t)s=t(e);else if(o)s=(0,r.createElement)(o,e);else if(void 0!==a)s=a;else throw l}return(0,r.createElement)(n.Provider,{value:{didCatch:i,error:l,resetErrorBoundary:this.resetErrorBoundary}},s)}constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=o}}function i(){let e=(0,r.useContext)(n);if(null==e||"boolean"!=typeof e.didCatch||"function"!=typeof e.resetErrorBoundary)throw Error("ErrorBoundaryContext not found");let[t,o]=(0,r.useState)({error:null,hasError:!1}),a=(0,r.useMemo)(()=>({resetBoundary:()=>{e.resetErrorBoundary(),o({error:null,hasError:!1})},showBoundary:e=>o({error:e,hasError:!0})}),[e.resetErrorBoundary]);if(t.hasError)throw t.error;return a}class l extends a{componentDidCatch(e,r){var n;super.componentDidCatch(e,r),(0,t.logError)("error-boundary",e.message,{componentStack:null!=(n=r.componentStack)?n:"no stack info"})}constructor(e){super(e)}}},186679,e=>{"use strict";e.s(["DelayedRender",()=>r]);var t=e.i(140578);function r(e){let{children:r,delayMs:n=200}=e,[o,a]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{let e=setTimeout(()=>{a(!0)},n);return()=>{clearTimeout(e)}},[n]),o?r:null}},593522,13330,e=>{"use strict";e.s(["FileError",()=>l],593522);var t=e.i(628925),r=e.i(763578),n=e.i(211959);e.i(685846);var o=e.i(164877);e.s(["RefreshCw",()=>a],13330);let a=(0,e.i(510965).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.i(968648);var i=e.i(873329);function l(e){let{onRetryRequested:l,title:s,message:c}=e,{t:u}=(0,i.useTranslation)("files");return(0,t.jsxs)("div",{className:(0,n.cn)("flex flex-col items-center justify-center h-full w-full p-4"),children:[(0,t.jsx)(o.AlertTriangle,{className:"mb-4",size:24}),(0,t.jsx)("h2",{className:"text-md font-semibold mb-2",children:s||u("file-open-error.title","Could not open file")}),(0,t.jsx)("p",{className:"text-sm text-fg-secondary mb-4 text-center max-w-sm",children:c||u("file-open-error.message","Something went wrong while trying to load the document. Please check your connection and try again.")}),l&&(0,t.jsxs)(r.Button,{variant:"outline",size:"md",onClick:l,className:"flex items-center gap-2",children:[(0,t.jsx)(a,{size:16,className:"text-fg-secondary"}),(0,t.jsx)("span",{className:"text-fg-primary font-semibold",children:u("file-open-error.retry","Retry")})]})]})}},280327,e=>{"use strict";e.s(["arrayToTable",()=>O,"copyTableToClipboard",()=>g,"delimitTable",()=>m],280327);var t=e.i(506327),r=e.i(570846),n=e.i(279236),o=e.i(61634),a=e.i(816220),i=e.i(820380),l=e.i(273638),s=e.i(360285),c=e.i(722365);function u(e,t,r){let n=r?function(e){let t=new Map;for(let r of e)t.set(r.toLowerCase(),r);return t}(r):void 0;return function(r,o){let s;for(var u=arguments.length,f=Array(u>2?u-2:0),p=2;p<u;p++)f[p-2]=arguments[p];if(null==r)s={type:"root",children:[]},f.unshift(o);else{let u=(s=(0,i.parseSelector)(r,t)).tagName.toLowerCase(),p=n?n.get(u):void 0;if(s.tagName=p||u,function(e){if(null===e||"object"!=typeof e||Array.isArray(e))return!0;if("string"!=typeof e.type)return!1;for(let t of Object.keys(e)){let r=e[t];if(r&&"object"==typeof r){if(!Array.isArray(r))return!0;for(let e of r)if("number"!=typeof e&&"string"!=typeof e)return!0}}return!!("children"in e&&Array.isArray(e.children))}(o))f.unshift(o);else for(let[t,r]of Object.entries(o))!function(e,t,r,n){let o,i=(0,l.find)(e,r);if(null!=n){if("number"==typeof n){if(Number.isNaN(n))return;o=n}else o="boolean"==typeof n?n:"string"==typeof n?i.spaceSeparated?(0,c.parse)(n):i.commaSeparated?(0,a.parse)(n):i.commaOrSpaceSeparated?(0,c.parse)((0,a.parse)(n).join(" ")):d(i,i.property,n):Array.isArray(n)?[...n]:"style"===i.property?function(e){let t=[];for(let[r,n]of Object.entries(e))t.push([r,n].join(": "));return t.join("; ")}(n):String(n);if(Array.isArray(o)){let e=[];for(let t of o)e.push(d(i,i.property,t));o=e}"className"===i.property&&Array.isArray(t.className)&&(o=t.className.concat(o)),t[i.property]=o}}(e,s.properties,t,r)}for(let e of f)!function e(t,r){if(null==r);else if("number"==typeof r||"string"==typeof r)t.push({type:"text",value:String(r)});else if(Array.isArray(r))for(let n of r)e(t,n);else if("object"==typeof r&&"type"in r)"root"===r.type?e(t,r.children):t.push(r);else throw Error("Expected node, nodes, or string, got `"+r+"`")}(s.children,e);return"element"===s.type&&"template"===s.tagName&&(s.content={type:"root",children:s.children},s.children=[]),s}}function d(e,t,r){if("string"==typeof r){if(e.number&&r&&!Number.isNaN(Number(r)))return Number(r);if((e.boolean||e.overloadedBoolean)&&(""===r||(0,s.normalize)(r)===(0,s.normalize)(t)))return!0}return r}let f=u(o.html,"div");u(o.svg,"g",["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"]);let p={csv:",",tsv:"	"};function h(e,t){let r=e.includes(t)||e.includes("\n")||e.includes('"'),n=e.replace(/"/g,'""');return r?'"'.concat(n,'"'):n}function m(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv",{headers:o,rows:a}=function(e){if("element"!==e.type||"table"!==e.tagName)throw Error("Expected a <table> element");let r=(0,t.select)("thead tr",e);return{headers:r?(0,t.selectAll)("th,td",r).map(n.toString).map(e=>e.trim()):[],rows:((0,t.selectAll)("tbody tr",e).length?(0,t.selectAll)("tbody tr",e):(0,t.selectAll)("tr",e).filter(e=>e!==r)).map(e=>(0,t.selectAll)("th,td",e).map(n.toString).map(e=>e.trim()))}}(e),i=p[r],l=[];for(let e of(o.length&&l.push(o.map(e=>h(e.trim(),i)).join(i)),a))l.push(e.map(e=>h(e.trim(),i)).join(i));return l.join("\n")}function g(e,t){var n;let o=m(e,"csv"),a='<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>'+(0,r.toHtml)(e),i=e=>{var t;null==(t=window.navigator.clipboard)||t.writeText(e)};(null==(n=window.navigator.clipboard)?void 0:n.write)!==void 0||(null==t?void 0:t.clipboardData)!==void 0?((e,r)=>{var n,o,a;try{if(void 0===t||null===t.clipboardData)throw Error("No clipboard data");null==t||null==(n=t.clipboardData)||n.setData("text/plain",e),null==t||null==(o=t.clipboardData)||o.setData("text/html",r)}catch(t){((null==(a=window.navigator.clipboard)?void 0:a.write)===void 0||(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([e],{type:"text/plain"}),"text/html":new Blob([r],{type:"text/html"})})]),0))&&i(e)}})(o,a):i(o),null==t||t.preventDefault()}function O(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.length)return f("table");let[r,...n]=e,o=e=>t=>f("tr",t.map(t=>f(e,t))),a=t&&r?f("thead",o("th")(r)):null,i=f("tbody",(t?n:e).map(o("td")));return f("table",[a,i].filter(Boolean))}},117521,e=>{"use strict";e.s(["EditorStateModel",()=>o,"getEditorView",()=>l]);var t=e.i(868275),r=e.i(564448);class n{updateState(e){this.set(e)}constructor(e,r){(0,t._)(this,"set",void 0),(0,t._)(this,"get",void 0),(0,t._)(this,"activeId",void 0),(0,t._)(this,"nodes",void 0),this.set=e,this.get=r,this.activeId=null,this.nodes={}}}class o{get state(){return this.view.state}setNodeProps(e){i.instance.updateState(t=>{var r;let n=null!=(r=t.nodes[this.id])?r:{};return t.nodes[this.id]={...n,...e},t})}get node(){return this.state.nodes[this.id]}destroy(){this.view.removeModel(this.id),i.instance.updateState(e=>(delete e.nodes[this.id],e))}static typeId(e,t){if(e in o.types)throw Error("Duplicate use of model type "+e);return o.types[e]=t,t.prototype.type=e,t}constructor(e){if((0,t._)(this,"id",void 0),(0,t._)(this,"view",void 0),this.id=e,!o.view)throw Error("EditorStateModel must be initialized with a valid EditorView");this.view=o.view,this.view.appendModel(this)}}(0,t._)(o,"view",void 0),(0,t._)(o,"types",Object.create(null));let a=e=>e;class i{static get instance(){return i.privateInstance||(i.privateInstance=new i),i.privateInstance}get state(){return this._state.getState()}updateState(e){this._state.setState(e)}appendModel(e){return void 0===this.models[e.id]&&(this.models[e.id]=e,!0)}removeModel(e){return!!this.models[e]&&(delete this.models[e],!0)}getModel(e){return this.models[e]}findById(e,t){e="string"==typeof e?o.types[e]:e;let r=this.models[t];if(void 0!==r&&r instanceof e)return r}useState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return this._state(e)}constructor(){(0,t._)(this,"models",{}),(0,t._)(this,"_state",void 0),this._state=(0,r.createImmerStore)(n,"EditorStateStore"),o.view=this}}function l(){return i.instance}(0,t._)(i,"privateInstance",void 0)},8583,e=>{e.v(e.b(["static/chunks/a5dd21abca44c2a7.js","static/chunks/90a2fdd544b2a227.js","static/chunks/turbopack-e783b7f415543f6e.js"]))},596222,505784,e=>{"use strict";e.s(["GridSelection",()=>Q,"SpreadsheetModel",()=>W,"SpreadsheetStoreProvider",()=>A,"useSpreadsheet",()=>q],596222);var t=e.i(868275),r=e.i(628925),n=e.i(280327),o=e.i(186679),a=e.i(315366),i=e.i(723008),l=e.i(117521),s=e.i(250267),c=e.i(140578);e.i(968648);var u=e.i(873329),d=e.i(593522);let f=new Worker(e.r(8583),{type:"module",type:void 0}),p=s.wrap(f);var h=e.i(536488);function m(){let e=q().error,{showBoundary:t,resetBoundary:r}=(0,h.useErrorBoundary)();return(0,c.useEffect)(()=>{e?t(e):r()},[e,t,r]),null}var g=e.i(880483);e.s(["colIndexToLabel",()=>b,"isCellSelection",()=>x,"isColSelection",()=>C,"isRangeSelection",()=>E,"isRowSelection",()=>P,"parseCellAddress",()=>v,"parseRange",()=>S,"rowIndexToLabel",()=>y,"selectionLabel",()=>k],505784);let O=/^(\$?)([A-Za-z]+)(\$?)(\d+)$/;function v(e){var t;let r=O.exec(e.trim());if(!r)throw Error('Invalid cell address: "'.concat(e,'"'));let[n,o,a,i,l]=r;if(void 0===a||void 0===l)throw Error('Invalid cell address: "'.concat(e,'"'));return{col:1===(t=a).length?t.toUpperCase().charCodeAt(0)-65:t.split("").reduce((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64),0)-1,row:Number(l)-1}}function S(e){let[t,r=t]=e.split(":");if(void 0===t||void 0===r)throw Error('Invalid range: "'.concat(e,'"'));let{col:n,row:o}=v(t),{col:a,row:i}=v(r);return{rowStart:Math.min(o,i),rowEnd:Math.max(o,i),colStart:Math.min(n,a),colEnd:Math.max(n,a),numCols:Math.max(n,a)-Math.min(n,a)+1,numRows:Math.max(o,i)-Math.min(o,i)+1}}function y(e){return String(e+1)}function b(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function w(e){if(!e.ranges||1!==e.ranges.length||!e.cell)return!1;let t=e.ranges[0];if(void 0===t)return!1;let r=e.cell;return 1===t.width&&1===t.height&&t.col===r.col&&t.row===r.row}function x(e){return!!e.cell&&0===e.cols.length&&0===e.rows.length&&(0===e.ranges.length||w(e))}function E(e){return 0===e.cols.length&&0===e.rows.length&&!w(e)}function C(e){return e.cols.length>0&&0===e.rows.length&&(0===e.ranges.length||w(e))}function P(e){return e.rows.length>0&&0===e.cols.length&&(0===e.ranges.length||w(e))}function k(e){if(!e)return{type:"empty",text:"Empty selection",label:""};if(x(e)){let{col:t,row:r}=e.cell,n="".concat(b(t)).concat(y(r));return{text:"".concat(n," (Cell with col ").concat(t," row ").concat(r," has been selected)"),label:n}}if(E(e)&&e.rect){let{colStart:t,rowStart:r,colEnd:n,rowEnd:o}=e.rect,a="".concat(b(t)).concat(y(r)),i="".concat(b(n-1)).concat(y(o-1));return{type:"range",text:"".concat(a,":").concat(i," (Cells from ").concat(a," to ").concat(i," have been selected)"),label:"".concat(a,":").concat(i),rect:e.rect}}if(C(e)&&e.rect){let{colStart:t,colEnd:r}=e.rect,n=b(t),o=b(r);return{type:"col",text:"".concat(n,":").concat(o," (Cols ").concat(t+1,"-").concat(r+1," have been selected)"),label:"".concat(n,":").concat(o),rect:e.rect}}if(P(e)&&e.rect){let{rowStart:t,rowEnd:r}=e.rect,n=y(t),o=y(r);return{type:"row",text:"".concat(n,":").concat(o," (Rows ").concat(t+1,"-").concat(r+1," have been selected)"),label:"".concat(n,":").concat(o),rect:e.rect}}return{type:"empty",text:"Empty selection",label:""}}class Q{eq(e){return JSON.stringify(this)===JSON.stringify(e)}toJSON(){return{type:"grid",...this}}setCell(e){var t;let r=[{col:e.col,row:e.row,width:1,height:1}].concat((null!=(t=this.ranges)?t:[]).slice(1));return new Q(this.sheet,e,r,this.cols,this.rows)}get editingCell(){return this.cell?{sheet:this.sheet,...this.cell}:null}get cellLabel(){return this.cell?"".concat(b(this.cell.col)).concat(y(this.cell.row)):""}get rect(){if(C(this)&&1===this.cols.length&&void 0!==this.cols[0]){let[e,t]=this.cols[0];return{type:"col",colStart:e,colEnd:t-1,rowStart:0,rowEnd:1024,numCols:t-e,numRows:0}}if(P(this)&&1===this.rows.length&&void 0!==this.rows[0]){let[e,t]=this.rows[0];return{type:"row",colStart:0,colEnd:64,rowStart:e,rowEnd:t-1,numCols:0,numRows:t-e}}if(E(this)&&1===this.ranges.length&&void 0!==this.ranges[0]){let e=this.ranges[0];return{type:"range",colStart:e.col,colEnd:e.col+e.width-1,rowStart:e.row,rowEnd:e.row+e.height-1,numCols:e.width,numRows:e.height}}return x(this)?{type:"cell",colStart:this.cell.col,colEnd:this.cell.col,rowStart:this.cell.row,rowEnd:this.cell.row,numCols:1,numRows:1}:null}constructor(e,r={col:0,row:0},n=[],o=[],a=[]){(0,t._)(this,"sheet",void 0),(0,t._)(this,"cell",void 0),(0,t._)(this,"ranges",void 0),(0,t._)(this,"cols",void 0),(0,t._)(this,"rows",void 0),this.sheet=e,this.cell=r,this.ranges=n,this.cols=o,this.rows=a}}let R=c.default.createContext(void 0),A=e=>{let{id:t,initialState:n={},children:s,content:f,readOnly:p=!1}=e,{t:h}=(0,u.useTranslation)("files");((e,t,r,n,o)=>{c.default.useRef(e).current=e;let a=c.default.useRef(void 0);return c.default.useEffect(function(){let i;if(void 0===r)return;let l=a.current;if(!l||l.id!==e)return null==l||l.destroy(),a.current=l=W.create(e,t),l.initCalcEngine({content:r,readOnly:n}).then(e=>{e&&o&&e.onCells(o).then(e=>i=e).catch(console.error)}).catch(console.error),()=>{null==i||i()}},[e,r]),c.default.useEffect(function(){let e=a.current;e&&e.initCalcEngine({content:r,readOnly:n,force:!0}).catch(console.error)},[n]),c.default.useEffect(function(){return()=>{a.current=void 0}},[])})(t,n,f,p);let g=(0,l.getEditorView)(),O=g.useState(e=>e.nodes[t]),v=g.getModel(t);return O&&void 0!==f&&void 0!==v?(0,r.jsx)(R.Provider,{value:t,children:(0,r.jsxs)(a.ErrorBoundary,{fallbackRender:()=>(0,r.jsx)(d.FileError,{message:h("spreadsheet-open-error.message","The file can't be opened right now. The file format is invalid.")}),children:[s,(0,r.jsx)(m,{})]})}):(0,r.jsx)(o.DelayedRender,{children:(0,r.jsx)("div",{className:"flex w-full h-full justify-center items-center",children:(0,r.jsx)(i.Spinner,{size:"sm"})})})},T={type:"sheet",highlights:[],activeSheet:0,selection:new Q(0),sheets:[],editingCell:{sheet:0,col:0,row:0},error:null},N={newSheet:function(e,t){let r=[...e.sheets];r[t.index]={name:t.name,rowCount:256,colCount:26},e.setNodeProps({sheets:r})},deleteSheet:function(e,t){let r=[...e.sheets];r.splice(t.sheet,1),e.setNodeProps({sheets:r})},renameSheet:function(e,t){let r=[...e.sheets],n=r[t.index];n&&(r[t.index]={...n,name:t.new_value},e.setNodeProps({sheets:r}))},setCellValue:async function(e,t){let r=[...e.sheets];return e.calcEngine.getSheetProperties().then(n=>{let o=n[t.sheet];if(!o)return;let{rowCount:a,colCount:i}=o;r[t.sheet]={...o,rowCount:a,colCount:i},e.setNodeProps({sheets:r})}).catch(console.error)},insertColumn:function(e,t){let r=[...e.sheets],n=r[t.sheet];n&&(r[t.sheet]={...n,colCount:n.colCount+1},e.setNodeProps({sheets:r}))},deleteColumn:function(e,t){let r=[...e.sheets],n=r[t.sheet];n&&(r[t.sheet]={...n,colCount:n.colCount-1},e.setNodeProps({sheets:r}))},insertRow:function(e,t){let r=[...e.sheets],n=r[t.sheet];n&&(r[t.sheet]={...n,rowCount:n.rowCount+1},e.setNodeProps({sheets:r}))},deleteRow:function(e,t){let r=[...e.sheets],n=r[t.sheet];n&&(r[t.sheet]={...n,rowCount:n.rowCount-1},e.setNodeProps({sheets:r}))}};class W extends l.EditorStateModel{static create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new W(e);return r.setNodeProps({...T,...t,id:e}),r}get name(){return this.node.name}get activeSheet(){return this.node.activeSheet}get sheets(){var e,t;return null!=(t=null==(e=this.node)?void 0:e.sheets)?t:[]}get highlights(){return this.node.highlights}get editingCell(){return this.node.editingCell}get selection(){return this.node.selection}get error(){return this.node.error}get calcEngine(){let e=W.engines.get(this.id);if(!e)throw Error("SpreadsheetModel: No engine found for id ".concat(this.id));return e}async initCalcEngine(e){let{content:t,readOnly:r,force:n=!1}=e;if(!n&&this.calcEngine)return;let o=this.node.name||"Workbook",a=r?g.XLSXReader.fromXLSX(t):null===t?p.initModel(o):p.fromXLSX(t);return await a.then(async e=>{W.engines.set(this.id,e);let t=await e.getSheetProperties();return this.setNodeProps({name:o,sheets:t}),e.onDiffs(s.proxy(e=>{for(let t of e){let e=N[t.type];null==e||e(this,t)}})).then(e=>this.dispose.push(e)).catch(console.error),e}).catch(e=>{e instanceof Error&&this.setNodeProps({error:e})}),this.calcEngine}destroy(){for(let e of(super.destroy(),W.engines.delete(this.id),this.dispose))e();this.dispose=[]}setNodeProps(e){e=function(e,t){if(t.sheets){var r;let n=t.sheets,o=null!=(r=t.activeSheet)?r:e.activeSheet,a=Math.max(0,Math.min(o,n.length-1));if(a!==o)return{...t,activeSheet:a}}return t}(this.node,e),super.setNodeProps({...e,type:"sheet",id:this.id})}async createSheet(e){return this.calcEngine.createSheet(e).catch(console.error)}async deleteSheet(e){return this.calcEngine.deleteSheet(e).catch(console.error)}async duplicateSheet(e){let t=this.sheets[e];if(!t)return;let r=function(e,t){var r;let{stem:n}=null==(r=I.exec(t))?void 0:r.groups,o=t=>e.includes(t);if(!o(t))return t;for(let e=2;;e++){let t="".concat(n," (").concat(e,")");if(!o(t))return t}}(this.sheets.map(e=>e.name),t.name),n={rowStart:0,rowEnd:t.rowCount,colStart:0,colEnd:t.colCount};return this.createSheet(r).then(t=>{if(t)return this.calcEngine.getCellsInRange(e,n).then(e=>{let r=e.map(e=>e.map(e=>e.serialized));this.calcEngine.setCellsInRange(t.sheetId,0,0,r).catch(console.error)}).catch(console.error),t})}async copySheet(e,t){let r=this.sheets[e];if(!r)return;let{rowCount:o,colCount:a}=r;return this.calcEngine.getCellsInRange(e,{rowStart:0,rowEnd:o,colStart:0,colEnd:a}).then(e=>{let r=(0,n.arrayToTable)(e.map(e=>e.map(e=>e.value)));(0,n.copyTableToClipboard)(r,t)}).catch(console.error)}async delimitSheet(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv",r=this.sheets[e];if(!r)return;let{rowCount:o,colCount:a}=r;return this.calcEngine.getCellsInRange(e,{rowStart:0,rowEnd:o,colStart:0,colEnd:a}).then(e=>{let r=(0,n.arrayToTable)(e.map(e=>e.map(e=>e.value)));return(0,n.delimitTable)(r,t)}).catch(console.error)}async renameSheet(e,t){return this.calcEngine.renameSheet(e,t).catch(console.error)}async insertRows(e,t,r){return this.calcEngine.insertRows(e,t,r).catch(console.error)}async insertCols(e,t,r){return this.calcEngine.insertCols(e,t,r).catch(console.error)}async deleteRows(e,t,r){return this.calcEngine.deleteRows(e,t,r).catch(console.error)}async deleteCols(e,t,r){return this.calcEngine.deleteCols(e,t,r).catch(console.error)}async clearCellsInRange(e,t){return this.calcEngine.clearCellsInRange(e,t).catch(console.error)}async setCellsInRange(e,t,r,n){return this.calcEngine.setCellsInRange(e,t,r,n).catch(console.error)}async copyCellsInRange(e,t){return this.calcEngine.getCellsInRange(e,t).then(e=>{let t=(0,n.arrayToTable)(e.map(e=>e.map(e=>e.value)));(0,n.copyTableToClipboard)(t)}).catch(console.error)}constructor(e){super(e),(0,t._)(this,"id",void 0),(0,t._)(this,"gridRefs",void 0),(0,t._)(this,"editor",void 0),(0,t._)(this,"dispose",void 0),this.id=e,this.gridRefs={},this.dispose=[]}}function q(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,l.getEditorView)(),r=c.default.useContext(R)||t.state.activeId;if(!r){if(e)throw Error("useSpreadsheet: An id must be provided or the activeId must be set.");return}t.useState(e=>e.nodes[r]);let n=t.findById(W,r);if(!n){if(e)throw Error('Spreadsheet "'.concat(r,'" not found.'));return}return n}(0,t._)(W,"type","sheet"),(0,t._)(W,"engines",new Map),l.EditorStateModel.typeId(W.type,W);let I=RegExp("^(?<stem>.*?)(?:\\s\\((?<suffix>\\d+)\\))?$")},701856,728243,e=>{"use strict";function t(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64),0)-1}function r(e){return Number(e)-1}function n(e){return String(e+1)}function o(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}e.s(["addressToRange",()=>p,"colIndexToLabel",()=>o,"rowIndexToLabel",()=>n],701856);let a="(".concat("[".concat("A-Za-zÀ-ʯ","0-9_]+"),"|").concat("'(((?!').|'')*)'",")!"),i="'((?:(?!').|'')*)'",l="(".concat("[A-Za-z0-9_À-ʯ]+","|").concat(i,")"),s="(?![A-Za-z0-9_À-ʯ])";"(".concat(a,")?\\").concat("$","?[A-Za-z]+\\").concat("$","?[0-9]+"),new RegExp("".concat(i));let c=new RegExp("(".concat(l,"!)?((\\").concat("$",")?([A-Za-z]+)(\\").concat("$",")?([0-9]+))").concat(s)),u=new RegExp("(".concat(l,"!)?((\\").concat("$",")?([A-Za-z]+)(\\").concat("$",")?([0-9]+))").concat(":","((\\").concat("$",")?([A-Za-z]+)(\\").concat("$",")?([0-9]+))").concat(s)),d=new RegExp("(".concat(l,"!)?((\\").concat("$",")?([A-Za-z]+)").concat(":","(\\").concat("$",")?([A-Za-z]+))").concat(s)),f=new RegExp("(".concat(l,"!)?((\\").concat("$",")?([0-9]+)").concat(":","(\\").concat("$",")?([0-9]+))").concat(s)),p=e=>{let n;if(n=d.exec(e)){let[e,r,o,a=o,i,l,s,c,u]=n;if(void 0===s||void 0===u)return;let d=t(s),f=t(u);return{type:"col",anchor:[Math.min(d,f),Number.MAX_SAFE_INTEGER],head:[Math.max(d,f),Number.MAX_SAFE_INTEGER],absolute:"$"==l&&"$"==c,sheetName:a}}if(n=f.exec(e)){let[e,t,o,a=o,i,l,s,c,u]=n;if(void 0===s||void 0===u)return;let d=r(s),f=r(u);return{type:"row",anchor:[Number.MAX_SAFE_INTEGER,Math.min(d,f)],head:[Number.MAX_SAFE_INTEGER,Math.max(d,f)],absolute:"$"==l&&"$"==c,sheetName:a}}if(n=u.exec(e)){let[e,o,a,i=a,l,s,c,u,d,f,p,h,m,g]=n;if(void 0===c||void 0===h||void 0===d||void 0===g)return;let O=t(c),v=r(d),S=t(h),y=r(g);return{type:"range",anchor:[Math.min(O,S),Math.min(v,y)],head:[Math.max(O,S),Math.max(v,y)],absoluteColA:"$"==s,absoluteRowA:"$"==u,absoluteColB:"$"==p,absoluteRowB:"$"==m,sheetName:i}}if(n=c.exec(e)){let[e,o,a,i=a,l,s,c,u,d]=n;if(void 0===c||void 0===d)return;let f=t(c),p=r(d);return{type:"cell",anchor:[f,p],head:[f,p],absoluteCol:"$"==s,absoluteRow:"$"==u,sheetName:i}}};e.s(["cellHighlights",()=>x,"cellHighlightsFacet",()=>y,"cellReferencesFacet",()=>S],728243);var h=e.i(868275),m=e.i(650218),g=e.i(334283);let O=["#3b82f6","#ef4444","#a855f7","#16a34a","#db2777","#f97316","#14b8a6"],v=m.Facet.define({combine:e=>e.length&&e[0]?e[0]:O});new m.Compartment;let S=m.Facet.define({combine:e=>e.flat().sort((e,t)=>e.from-t.from)}),y=m.Facet.define({combine:e=>e.flat().sort((e,t)=>e.from-t.from)}),b=y.compute([S,v],e=>{let t=e.facet(S),r=e.facet(v),n=new Map,o=[];return t.forEach(e=>{var t;let{selection:a}=e,i=a.rangeId,l=null!=(t=n.get(i))?t:r[n.size%r.length];l&&(n.set(i,l),o.push({...e,color:l,range:a.rect}))}),o}),w=g.ViewPlugin.fromClass(class{update(e){(e.docChanged||e.state.facet(y)!==e.startState.facet(y))&&(this.decorations=this.computeDecos(e.view))}computeDecos(e){let t=new m.RangeSetBuilder;return e.state.facet(y).forEach(e=>{let{color:r,from:n,to:o}=e;t.add(n,o,g.Decoration.mark({class:"cm-cell-reference",attributes:{style:"color: ".concat(r)}}))}),t.finish()}constructor(e){(0,h._)(this,"decorations",void 0),this.decorations=this.computeDecos(e)}},{decorations:e=>e.decorations}),x=[b,m.Prec.highest(w)]},406845,517166,e=>{"use strict";e.s(["cellModeKeymapExt",()=>m,"handlePointerDown",()=>d],406845);var t=e.i(650218),r=e.i(334283),n=e.i(476238);e.s(["DEFAULT_SPREADSHEET_STATE",()=>o,"sheetStateCompartment",()=>l,"sheetViewCompartment",()=>s,"spreadsheetState",()=>a,"spreadsheetView",()=>i,"updateSpreadsheetState",()=>c],517166);let o={cell:{sheet:0,col:0,row:0},sheetProperties:{0:{name:"Sheet1",rowCount:256,colCount:26}}},a=t.Facet.define({combine:e=>{var t;return null!=(t=e[0])?t:o}}),i=t.Facet.define({combine:e=>{var t;return null!=(t=e[0])?t:{cellFromPointer:()=>void 0,scrollToCell:()=>{}}}}),l=new t.Compartment,s=new t.Compartment;function c(e){return function(t){let{state:r,dispatch:n}=t,o=r.facet(a);return n(r.update({effects:[l.reconfigure(a.of({...o,...e}))]})),!0}}function u(e,r){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=e.state.field(n.cellModeState,!1),s=e.state.facet(a);if(!l||l.mode!==n.CellMode.Point&&!(0,n.canPoint)(e.state))return!1;let{anchor:c,head:u=c}=l.mode===n.CellMode.Point?l.cellSelection:{anchor:[s.cell.col,s.cell.row]};c=o?c:r,u=r;let d=new n.CellSelection(c,u).address,{from:f,to:p}=l.mode===n.CellMode.Point?l.range:e.state.selection.main;return e.state.facet(i).scrollToCell({sheet:s.cell.sheet,col:u[0],row:u[1]}),e.dispatch({changes:{from:f,to:p,insert:d},selection:t.EditorSelection.range(f+d.length,f+d.length),effects:[n.setCellSelection.of({range:{from:f,to:f+d.length},cellSelection:{sheet:s.cell.sheet,anchor:c,head:u},mode:n.CellMode.Point})]}),!0}function d(e,t){if(!t.hasFocus||t.dom.contains(e.target)||e.ctrlKey||e.metaKey)return!1;let r=t.state.field(n.cellModeState,!1);if(!r||r.mode!==n.CellMode.Point&&!(0,n.canPoint)(t.state))return!1;e.preventDefault(),e.stopImmediatePropagation();let o=document.querySelector("#portal");function l(){o.style.pointerEvents="",window.removeEventListener("pointerup",l),window.removeEventListener("dragstart",l),window.removeEventListener("pointermove",s)}function s(e){window.requestAnimationFrame(()=>{let r=t.state.field(n.cellModeState,!1);if(!r||r.mode!==n.CellMode.Point&&!(0,n.canPoint)(t.state))return!1;let o=t.state.facet(a),l=t.state.facet(i).cellFromPointer(e);if(!l)return!1;let s=r.mode===n.CellMode.Point?r.cellSelection.head:[o.cell.col,o.cell.row];if(l.col===s[0]&&l.row===s[1])return!1;let c=r.mode===n.CellMode.Point&&l.sheet===r.cellSelection.sheet;u(t,[l.col,l.row],c)})}if(window.addEventListener("pointerup",l),window.addEventListener("dragstart",l),window.addEventListener("pointermove",s),t.dom.contains(e.target))return!1;let c=t.state.facet(i).cellFromPointer(e);if(!c)return!1;e.preventDefault(),e.stopImmediatePropagation();let d=e.shiftKey&&r.mode===n.CellMode.Point&&c.sheet===r.cellSelection.sheet;u(t,[c.col,c.row],d),o.style.pointerEvents="none"}function f(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o=>{let i=o.state.field(n.cellModeState,!1),l=o.state.facet(a);if(!i)return!1;if(i.mode===n.CellMode.Point){let n;if(i.cellSelection){let{anchor:e,head:t=e}=i.cellSelection;n=r?t:e}else n=[l.cell.col,l.cell.row];let a=l.sheetProperties[l.cell.sheet];if(!a)return!1;let s=a["horiz"===e?"colCount":"rowCount"];return void 0!==n[0]&&void 0!==n[1]&&u(o,["horiz"===e?Math.min(Math.max(n[0]+t,0),s):n[0],"horiz"===e?n[1]:Math.min(Math.max(n[1]+t,0),s)],r)}if((0,n.canPoint)(o.state)&&o.state.selection.main.empty){let r=l.cell.col,n=l.cell.row,a=l.sheetProperties[l.cell.sheet];if(!a)return!1;let i="horiz"===e?r+t:r,s="horiz"===e?n:n+t;return u(o,[i=Math.min(Math.max(i,0),a.colCount),s=Math.min(Math.max(s,0),a.rowCount)],!1)}return!1}}function p(e){return t=>{let r=t.state.field(n.cellModeState,!1),o=t.state.facet(a);if(!r||r.mode!==n.CellMode.Point)return!1;let i="horiz"===e?-1:o.cell.col,l="horiz"===e?o.cell.row:-1;if(r.cellSelection){let{anchor:t,head:n=t}=r.cellSelection;"horiz"===e?l=n[1]:i=n[0]}return u(t,[i,l],!0)}}let h=[{key:"ArrowDown",run:f("vert",1),shift:f("vert",1,!0)},{key:"ArrowUp",run:f("vert",-1),shift:f("vert",-1,!0)},{key:"ArrowRight",run:f("horiz",1),shift:f("horiz",1,!0)},{key:"ArrowLeft",run:f("horiz",-1),shift:f("horiz",-1,!0)},{key:"Ctrl-Space",run:p("vert"),preventDefault:!0},{key:"Shift-Space",run:p("horiz"),preventDefault:!0},{key:"Mod-e",run:n.toggleEditMode,preventDefault:!0},{key:"F2",run:n.toggleEditMode,preventDefault:!0}],m=t.Prec.high(r.keymap.computeN([],()=>[h]))},476238,e=>{"use strict";e.s(["CellMode",()=>p,"CellSelection",()=>f,"canPoint",()=>v,"capturePointerEventToEditorView",()=>y,"cellMode",()=>c,"cellModeState",()=>m,"setCellSelection",()=>u,"toggleEditMode",()=>w]);var t=e.i(868275),r=e.i(255791),n=e.i(650218),o=e.i(334283),a=e.i(701856),i=e.i(728243),l=e.i(406845);let s=new Set(["CellToken","RangeToken","RowRangeToken","ColRangeToken","ReferenceItem","Reference"]);function c(){return[m,l.cellModeKeymapExt,n.Prec.highest(S)]}let u=n.StateEffect.define(),d=e=>-1===e||e===Number.MAX_SAFE_INTEGER||e===1/0;class f{get isColSelection(){let[e,t]=this.anchor,[r,n]=this.head;return d(t)||d(n)}get isRowSelection(){let[e,t]=this.anchor,[r,n]=this.head;return d(e)||d(r)}get isAllSelection(){return this.isColSelection&&this.isRowSelection}get isCellSelection(){let[e,t]=this.anchor,[r,n]=this.head;return!this.isColSelection&&!this.isRowSelection&&e===r&&t===n}get isRangeSelection(){let[e,t]=this.anchor,[r,n]=this.head;return!this.isCellSelection&&e!==r||t!==n}eq(e){return e.anchor[0]===this.anchor[0]&&e.anchor[1]===this.anchor[1]&&e.head[0]===this.head[0]&&e.head[1]===this.head[1]}get address(){let[e,t]=this.anchor,[r,n]=this.head;return this.isRowSelection?"".concat((0,a.rowIndexToLabel)(t),":").concat((0,a.rowIndexToLabel)(n)):this.isColSelection?"".concat((0,a.colIndexToLabel)(e),":").concat((0,a.colIndexToLabel)(r)):this.isCellSelection?"".concat((0,a.colIndexToLabel)(e)).concat((0,a.rowIndexToLabel)(t)):this.isRangeSelection?"".concat((0,a.colIndexToLabel)(e)).concat((0,a.rowIndexToLabel)(t),":").concat((0,a.colIndexToLabel)(r)).concat((0,a.rowIndexToLabel)(n)):""}get rect(){let[e,t]=this.anchor,[r,n]=this.head;return this.isAllSelection?{x:0,y:0,width:Number.MAX_SAFE_INTEGER,height:Number.MAX_SAFE_INTEGER}:this.isColSelection?{x:Math.min(e,r),y:0,width:Math.abs(r-e)+1,height:Number.MAX_SAFE_INTEGER}:this.isRowSelection?{x:0,y:Math.min(t,n),width:Number.MAX_SAFE_INTEGER,height:Math.abs(n-t)+1}:{x:Math.min(e,r),y:Math.min(t,n),width:Math.abs(r-e)+1,height:Math.abs(n-t)+1}}get rangeId(){return JSON.stringify(this.rect)}get reversed(){return new f(this.head,this.anchor)}eqRange(e){return this.rangeId===e.rangeId}constructor(e,r=e){(0,t._)(this,"anchor",void 0),(0,t._)(this,"head",void 0),this.anchor=e,this.head=r}}var p=function(e){return e.Ready="Ready",e.Enter="Enter",e.Point="Point",e.Edit="Edit",e}({});let h={mode:"Enter"},m=n.StateField.define({create:()=>({mode:"Enter"}),update(e,t){for(let e of t.effects)if(e.is(u))return e.value;return(t.docChanged||t.selection)&&("Enter"===e.mode||"Point"===e.mode)?b(t.state):e},provide:e=>i.cellReferencesFacet.from(e,e=>{if("Point"!==e.mode)return[];let{anchor:t,head:r}=e.cellSelection,n=new f(t,r);return[{from:e.range.from,to:e.range.to,selection:n}]})}),g=o.Decoration.widget({widget:new class extends o.WidgetType{toDOM(){let e=document.createElement("span");return e.textContent="⎵",e.className="cm-cell-range-marker",e}ignoreEvent(){return!1}},side:1}),O=o.Decoration.mark({class:"cm-underline"});function v(e){let t=e.field(m,!1);return!!t&&"Enter"===t.mode&&e.selection.main.empty&&function(e,t){let n=(0,r.syntaxTree)(e).resolve(t,-1);for(;n;){let e=n.name;if("TextToken"===e||"Number"===e||"BoolToken"===e||"ErrorToken"===e)break;if("CellToken"===e||"RowRangeToken"===e||"ColRangeToken"===e||"RangeToken"===e||"ReferenceItem"===e||"Reference"===e||"ArithOp"===e||"ArgList"===e||"Separator"===e||"FormulaWithEq"===e||"Formula"===e)return!0;n=n.parent}return!1}(e,e.selection.main.head)}let S=o.ViewPlugin.fromClass(class{update(e){this.decorations=this.buildDeco(e.view)}buildDeco(e){let t=e.state,r=e.state.field(m,!1),o=new n.RangeSetBuilder;if(!r||!e.hasFocus)return o.finish();if("Point"===r.mode&&o.add(r.range.from,r.range.to,O),v(e.state)){let e=t.selection.main.to;o.add(e,e,g)}return o.finish()}constructor(e){(0,t._)(this,"view",void 0),(0,t._)(this,"decorations",void 0),this.view=e,this.decorations=this.buildDeco(e)}},{decorations:e=>e.decorations});function y(e,t){let r=e.state.field(m,!1);return!(!r||!e.hasFocus||e.dom.contains(t.target))&&("Point"===r.mode||v(e.state))}function b(e){let t=e.selection.main;if(!t.empty)return h;let n=function(e,t){let n=n=>{let o,a=(0,r.syntaxTree)(e).resolve(t,n);for(;a;)s.has(a.name)&&(o=a),a=a.parent;return o};return n(-1)||n(1)}(e,t.head);if(!n)return h;let o=e.sliceDoc(n.from,n.to),i=(0,a.addressToRange)(o);return i?{mode:"Point",range:n,cellSelection:{sheet:0,anchor:[...i.anchor],head:[...i.head]}}:h}function w(e){let t=e.state.field(m,!1);if(!t)return!1;switch(t.mode){case"Ready":case"Edit":{let t=b(e.state);return e.dispatch({effects:u.of(t)}),!0}case"Point":case"Enter":return e.dispatch({effects:u.of({mode:"Edit"})}),!0;default:return!1}}},162284,e=>{"use strict";e.s(["cursorDocEnd",()=>el,"defaultKeymap",()=>eP,"history",()=>g,"historyKeymap",()=>A,"selectAll",()=>eu]);var t=e.i(650218),r=e.i(334283),n=e.i(255791),o=e.i(725915);function a(e,t){return r=>{let{state:n,dispatch:o}=r;if(n.readOnly)return!1;let a=e(t,n);return!!a&&(o(n.update(a)),!0)}}let i=a(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.selection.ranges,n=[],o=-1;for(let{from:e,to:a}of r){let r=n.length,i=1e9,l=c(t,e).line;if(l){for(let r=e;r<=a;){let s=t.doc.lineAt(r);if(s.from>o&&(e==a||a>s.from)){o=s.from;let e=/^\s*/.exec(s.text)[0].length,t=e==s.length,r=s.text.slice(e,e+l.length)==l?e:-1;e<s.text.length&&e<i&&(i=e),n.push({line:s,comment:r,token:l,indent:e,empty:t,single:!1})}r=s.to+1}if(i<1e9)for(let e=r;e<n.length;e++)n[e].indent<n[e].line.text.length&&(n[e].indent=i);n.length==r+1&&(n[r].single=!0)}}if(2!=e&&n.some(e=>e.comment<0&&(!e.empty||e.single))){let e=[];for(let{line:t,token:r,indent:o,empty:a,single:i}of n)(i||!a)&&e.push({from:t.from+o,insert:r+" "});let r=t.changes(e);return{changes:r,selection:t.selection.map(r,1)}}if(1!=e&&n.some(e=>e.comment>=0)){let e=[];for(let{line:t,comment:r,token:o}of n)if(r>=0){let n=t.from+r,a=n+o.length;" "==t.text[a-t.from]&&a++,e.push({from:n,to:a})}return{changes:e}}return null},0),l=a(u,0),s=a((e,t)=>u(e,t,function(e){let t=[];for(let r of e.selection.ranges){let n=e.doc.lineAt(r.from),o=r.to<=n.to?n:e.doc.lineAt(r.to);o.from>n.from&&o.from==r.to&&(o=r.to==n.to+1?n:e.doc.lineAt(r.to-1));let a=t.length-1;a>=0&&t[a].to>n.from?t[a].to=o.to:t.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:o.to})}return t}(t)),0);function c(e,t){let r=e.languageDataAt("commentTokens",t,1);return r.length?r[0]:{}}function u(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.selection.ranges,n=r.map(e=>c(t,e.from).block);if(!n.every(e=>e))return null;let o=r.map((e,r)=>(function(e,t,r,n){let o,a,{open:i,close:l}=t,s=e.sliceDoc(r-50,r),c=e.sliceDoc(n,n+50),u=/\s*$/.exec(s)[0].length,d=/^\s*/.exec(c)[0].length,f=s.length-u;if(s.slice(f-i.length,f)==i&&c.slice(d,d+l.length)==l)return{open:{pos:r-u,margin:u&&1},close:{pos:n+d,margin:d&&1}};n-r<=100?o=a=e.sliceDoc(r,n):(o=e.sliceDoc(r,r+50),a=e.sliceDoc(n-50,n));let p=/^\s*/.exec(o)[0].length,h=/\s*$/.exec(a)[0].length,m=a.length-h-l.length;return o.slice(p,p+i.length)==i&&a.slice(m,m+l.length)==l?{open:{pos:r+p+i.length,margin:+!!/\s/.test(o.charAt(p+i.length))},close:{pos:n-h-l.length,margin:+!!/\s/.test(a.charAt(m-1))}}:null})(t,n[r],e.from,e.to));if(2!=e&&!o.every(e=>e))return{changes:t.changes(r.map((e,t)=>o[t]?[]:[{from:e.from,insert:n[t].open+" "},{from:e.to,insert:" "+n[t].close}]))};if(1!=e&&o.some(e=>e)){let e=[];for(let t=0,r;t<o.length;t++)if(r=o[t]){let o=n[t],{open:a,close:i}=r;e.push({from:a.pos-o.open.length,to:a.pos+a.margin},{from:i.pos-i.margin,to:i.pos+o.close.length})}return{changes:e}}return null}let d=t.Annotation.define(),f=t.Annotation.define(),p=t.Facet.define(),h=t.Facet.define({combine:e=>(0,t.combineConfig)(e,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(r,n)=>e(r,n)||t(r,n)})}),m=t.StateField.define({create:()=>R.empty,update(e,r){let n=r.state.facet(h),o=r.annotation(d);if(o){let t=w.fromTransaction(r,o.selection),a=o.side,i=0==a?e.undone:e.done;return i=t?x(i,i.length,n.minDepth,t):P(i,r.startState.selection),new R(0==a?o.rest:i,0==a?i:o.rest)}let a=r.annotation(f);if(("full"==a||"before"==a)&&(e=e.isolate()),!1===r.annotation(t.Transaction.addToHistory))return r.changes.empty?e:e.addMapping(r.changes.desc);let i=w.fromTransaction(r),l=r.annotation(t.Transaction.time),s=r.annotation(t.Transaction.userEvent);return i?e=e.addChanges(i,l,s,n,r):r.selection&&(e=e.addSelection(r.startState.selection,l,s,n.newGroupDelay)),("full"==a||"after"==a)&&(e=e.isolate()),e},toJSON:e=>({done:e.done.map(e=>e.toJSON()),undone:e.undone.map(e=>e.toJSON())}),fromJSON:e=>new R(e.done.map(w.fromJSON),e.undone.map(w.fromJSON))});function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[m,h.of(e),r.EditorView.domEventHandlers({beforeinput(e,t){let r="historyUndo"==e.inputType?v:"historyRedo"==e.inputType?S:null;return!!r&&(e.preventDefault(),r(t))}})]}function O(e,t){return function(r){let{state:n,dispatch:o}=r;if(!t&&n.readOnly)return!1;let a=n.field(m,!1);if(!a)return!1;let i=a.pop(e,n,t);return!!i&&(o(i),!0)}}let v=O(0,!1),S=O(1,!1),y=O(0,!0),b=O(1,!0);class w{setSelAfter(e){return new w(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,r;return{changes:null==(e=this.changes)?void 0:e.toJSON(),mapped:null==(t=this.mapped)?void 0:t.toJSON(),startSelection:null==(r=this.startSelection)?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(e=>e.toJSON())}}static fromJSON(e){return new w(e.changes&&t.ChangeSet.fromJSON(e.changes),[],e.mapped&&t.ChangeDesc.fromJSON(e.mapped),e.startSelection&&t.EditorSelection.fromJSON(e.startSelection),e.selectionsAfter.map(t.EditorSelection.fromJSON))}static fromTransaction(e,t){let r=C;for(let t of e.startState.facet(p)){let n=t(e);n.length&&(r=r.concat(n))}return!r.length&&e.changes.empty?null:new w(e.changes.invert(e.startState.doc),r,void 0,t||e.startState.selection,C)}static selection(e){return new w(void 0,C,void 0,void 0,e)}constructor(e,t,r,n,o){this.changes=e,this.effects=t,this.mapped=r,this.startSelection=n,this.selectionsAfter=o}}function x(e,t,r,n){let o=e.slice(t+1>r+20?t-r-1:0,t);return o.push(n),o}function E(e,t){return e.length?t.length?e.concat(t):e:t}let C=[];function P(e,t){if(!e.length)return[w.selection([t])];{let r=e[e.length-1],n=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-200));return n.length&&n[n.length-1].eq(t)?e:(n.push(t),x(e,e.length-1,1e9,r.setSelAfter(n)))}}function k(e,r){if(!e.length)return e;let n=e.length,o=C;for(;n;){let a=function(e,r,n){let o=E(e.selectionsAfter.length?e.selectionsAfter.map(e=>e.map(r)):C,n);if(!e.changes)return w.selection(o);let a=e.changes.map(r),i=r.mapDesc(e.changes,!0),l=e.mapped?e.mapped.composeDesc(i):i;return new w(a,t.StateEffect.mapEffects(e.effects,r),l,e.startSelection.map(i),o)}(e[n-1],r,o);if(a.changes&&!a.changes.empty||a.effects.length){let t=e.slice(0,n);return t[n-1]=a,t}r=a.mapped,n--,o=a.selectionsAfter}return o.length?[w.selection(o)]:C}let Q=/^(input\.type|delete)($|\.)/;class R{isolate(){return this.prevTime?new R(this.done,this.undone):this}addChanges(e,r,n,o,a){var i,l;let s,c,u=this.done,d=u[u.length-1];return new R(u=d&&d.changes&&!d.changes.empty&&e.changes&&(!n||Q.test(n))&&(!d.selectionsAfter.length&&r-this.prevTime<o.newGroupDelay&&o.joinToEvent(a,(i=d.changes,l=e.changes,s=[],c=!1,i.iterChangedRanges((e,t)=>s.push(e,t)),l.iterChangedRanges((e,t,r,n)=>{for(let e=0;e<s.length;){let t=s[e++],o=s[e++];n>=t&&r<=o&&(c=!0)}}),c))||"input.type.compose"==n)?x(u,u.length-1,o.minDepth,new w(e.changes.compose(d.changes),E(t.StateEffect.mapEffects(e.effects,d.changes),d.effects),d.mapped,d.startSelection,C)):x(u,u.length,o.minDepth,e),C,r,n)}addSelection(e,t,r,n){var o;let a=this.done.length?this.done[this.done.length-1].selectionsAfter:C;return a.length>0&&t-this.prevTime<n&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&(o=a[a.length-1],o.ranges.length==e.ranges.length&&0===o.ranges.filter((t,r)=>t.empty!=e.ranges[r].empty).length)?this:new R(P(this.done,e),this.undone,t,r)}addMapping(e){return new R(k(this.done,e),k(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,r){let n=0==e?this.done:this.undone;if(0==n.length)return null;let o=n[n.length-1],a=o.selectionsAfter[0]||t.selection;if(r&&o.selectionsAfter.length){let r,i;return t.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:d.of({side:e,rest:(r=n[n.length-1],(i=n.slice())[n.length-1]=r.setSelAfter(r.selectionsAfter.slice(0,r.selectionsAfter.length-1)),i),selection:a}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:!0})}{if(!o.changes)return null;let r=1==n.length?C:n.slice(0,n.length-1);return o.mapped&&(r=k(r,o.mapped)),t.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:d.of({side:e,rest:r,selection:a}),filter:!1,userEvent:0==e?"undo":"redo",scrollIntoView:!0})}}constructor(e,t,r=0,n){this.done=e,this.undone=t,this.prevTime=r,this.prevUserEvent=n}}R.empty=new R(C,C);let A=[{key:"Mod-z",run:v,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:S,preventDefault:!0},{linux:"Ctrl-Shift-z",run:S,preventDefault:!0},{key:"Mod-u",run:y,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:b,preventDefault:!0}];function T(e,r){return t.EditorSelection.create(e.ranges.map(r),e.mainIndex)}function N(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function W(e,t){let{state:r,dispatch:n}=e,o=T(r.selection,t);return!o.eq(r.selection,!0)&&(n(N(r,o)),!0)}function q(e,r){return t.EditorSelection.cursor(r?e.to:e.from)}function I(e,t){return W(e,r=>r.empty?e.moveByChar(r,t):q(r,t))}function M(e){return e.textDirectionAt(e.state.selection.main.head)==r.Direction.LTR}let X=e=>I(e,!M(e)),D=e=>I(e,M(e));function j(e,t){return W(e,r=>r.empty?e.moveByGroup(r,t):q(r,t))}function B(e,r,a){let i,l,s=(0,n.syntaxTree)(e).resolveInner(r.head),c=a?o.NodeProp.closedBy:o.NodeProp.openedBy;for(let t=r.head;;){let r=a?s.childAfter(t):s.childBefore(t);if(!r)break;!function(e,t,r){if(t.type.prop(r))return!0;let n=t.to-t.from;return n&&(n>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}(e,r,c)?t=a?r.to:r.from:s=r}return l=s.type.prop(c)&&(i=a?(0,n.matchBrackets)(e,s.from,1):(0,n.matchBrackets)(e,s.to,-1))&&i.matched?a?i.end.to:i.end.from:a?s.to:s.from,t.EditorSelection.cursor(l,a?-1:1)}function z(e,t){return W(e,r=>{if(!r.empty)return q(r,t);let n=e.moveVertically(r,t);return n.head!=r.head?n:e.moveToLineBoundary(r,t)})}"undefined"!=typeof Intl&&Intl.Segmenter;let _=e=>z(e,!1),V=e=>z(e,!0);function F(e){let t=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,n=0,o=0,a;if(t){for(let t of e.state.facet(r.EditorView.scrollMargins)){let r=t(e);(null==r?void 0:r.top)&&(n=Math.max(null==r?void 0:r.top,n)),(null==r?void 0:r.bottom)&&(o=Math.max(null==r?void 0:r.bottom,o))}a=e.scrollDOM.clientHeight-n-o}else a=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:o,selfScroll:t,height:Math.max(e.defaultLineHeight,a-5)}}function L(e,t){let n,o=F(e),{state:a}=e,i=T(a.selection,r=>r.empty?e.moveVertically(r,t,o.height):q(r,t));if(i.eq(a.selection))return!1;if(o.selfScroll){let t=e.coordsAtPos(a.selection.main.head),l=e.scrollDOM.getBoundingClientRect(),s=l.top+o.marginTop,c=l.bottom-o.marginBottom;t&&t.top>s&&t.bottom<c&&(n=r.EditorView.scrollIntoView(i.main.head,{y:"start",yMargin:t.top-s}))}return e.dispatch(N(a,i),{effects:n}),!0}let U=e=>L(e,!1),G=e=>L(e,!0);function Y(e,r,n){let o=e.lineBlockAt(r.head),a=e.moveToLineBoundary(r,n);if(a.head==r.head&&a.head!=(n?o.to:o.from)&&(a=e.moveToLineBoundary(r,n,!1)),!n&&a.head==o.from&&o.length){let n=/^\s*/.exec(e.state.sliceDoc(o.from,Math.min(o.from+100,o.to)))[0].length;n&&r.head!=o.from+n&&(a=t.EditorSelection.cursor(o.from+n))}return a}function Z(e,r){let n=T(e.state.selection,e=>{let n=r(e);return t.EditorSelection.range(e.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return!n.eq(e.state.selection)&&(e.dispatch(N(e.state,n)),!0)}function $(e,t){return Z(e,r=>e.moveByChar(r,t))}let H=e=>$(e,!M(e)),J=e=>$(e,M(e));function K(e,t){return Z(e,r=>e.moveByGroup(r,t))}function ee(e,t){return Z(e,r=>e.moveVertically(r,t))}let et=e=>ee(e,!1),er=e=>ee(e,!0);function en(e,t){return Z(e,r=>e.moveVertically(r,t,F(e).height))}let eo=e=>en(e,!1),ea=e=>en(e,!0),ei=e=>{let{state:t,dispatch:r}=e;return r(N(t,{anchor:0})),!0},el=e=>{let{state:t,dispatch:r}=e;return r(N(t,{anchor:t.doc.length})),!0},es=e=>{let{state:t,dispatch:r}=e;return r(N(t,{anchor:t.selection.main.anchor,head:0})),!0},ec=e=>{let{state:t,dispatch:r}=e;return r(N(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0},eu=e=>{let{state:t,dispatch:r}=e;return r(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0};function ed(e,n){if(e.state.readOnly)return!1;let o="delete.selection",{state:a}=e,i=a.changeByRange(r=>{let{from:a,to:i}=r;if(a==i){let t=n(r);t<a?(o="delete.backward",t=ef(e,t,!1)):t>a&&(o="delete.forward",t=ef(e,t,!0)),a=Math.min(a,t),i=Math.max(i,t)}else a=ef(e,a,!1),i=ef(e,i,!0);return a==i?{range:r}:{changes:{from:a,to:i},range:t.EditorSelection.cursor(a,a<r.head?-1:1)}});return!i.changes.empty&&(e.dispatch(a.update(i,{scrollIntoView:!0,userEvent:o,effects:"delete.selection"==o?r.EditorView.announce.of(a.phrase("Selection deleted")):void 0})),!0)}function ef(e,t,n){if(e instanceof r.EditorView)for(let o of e.state.facet(r.EditorView.atomicRanges).map(t=>t(e)))o.between(t,t,(e,r)=>{e<t&&r>t&&(t=n?r:e)});return t}let ep=(e,r,o)=>ed(e,a=>{let i=a.from,{state:l}=e,s=l.doc.lineAt(i),c,u;if(o&&!r&&i>s.from&&i<s.from+200&&!/[^ \t]/.test(c=s.text.slice(0,i-s.from))){if("	"==c[c.length-1])return i-1;let e=(0,t.countColumn)(c,l.tabSize)%(0,n.getIndentUnit)(l)||(0,n.getIndentUnit)(l);for(let t=0;t<e&&" "==c[c.length-1-t];t++)i--;u=i}else(u=(0,t.findClusterBreak)(s.text,i-s.from,r,r)+s.from)==i&&s.number!=(r?l.doc.lines:1)?u+=r?1:-1:!r&&/[\ufe00-\ufe0f]/.test(s.text.slice(u-s.from,i-s.from))&&(u=(0,t.findClusterBreak)(s.text,u-s.from,!1,!1)+s.from);return u}),eh=e=>ep(e,!1,!0),em=e=>ep(e,!0,!1),eg=(e,r)=>ed(e,n=>{let o=n.head,{state:a}=e,i=a.doc.lineAt(o),l=a.charCategorizer(o);for(let e=null;;){if(o==(r?i.to:i.from)){o==n.head&&i.number!=(r?a.doc.lines:1)&&(o+=r?1:-1);break}let s=(0,t.findClusterBreak)(i.text,o-i.from,r)+i.from,c=i.text.slice(Math.min(o,s)-i.from,Math.max(o,s)-i.from),u=l(c);if(null!=e&&u!=e)break;(" "!=c||o!=n.head)&&(e=u),o=s}return o}),eO=e=>eg(e,!1);function ev(e){let t=[],r=-1;for(let n of e.selection.ranges){let o=e.doc.lineAt(n.from),a=e.doc.lineAt(n.to);if(n.empty||n.to!=a.from||(a=e.doc.lineAt(n.to-1)),r>=o.number){let e=t[t.length-1];e.to=a.to,e.ranges.push(n)}else t.push({from:o.from,to:a.to,ranges:[n]});r=a.number+1}return t}function eS(e,r,n){if(e.readOnly)return!1;let o=[],a=[];for(let r of ev(e)){if(n?r.to==e.doc.length:0==r.from)continue;let i=e.doc.lineAt(n?r.to+1:r.from-1),l=i.length+1;if(n)for(let n of(o.push({from:r.to,to:i.to},{from:r.from,insert:i.text+e.lineBreak}),r.ranges))a.push(t.EditorSelection.range(Math.min(e.doc.length,n.anchor+l),Math.min(e.doc.length,n.head+l)));else for(let n of(o.push({from:i.from,to:r.from},{from:r.to,insert:e.lineBreak+i.text}),r.ranges))a.push(t.EditorSelection.range(n.anchor-l,n.head-l))}return!!o.length&&(r(e.update({changes:o,scrollIntoView:!0,selection:t.EditorSelection.create(a,e.selection.mainIndex),userEvent:"move.line"})),!0)}function ey(e,t,r){if(e.readOnly)return!1;let n=[];for(let t of ev(e))r?n.push({from:t.from,insert:e.doc.slice(t.from,t.to)+e.lineBreak}):n.push({from:t.to,insert:e.lineBreak+e.doc.slice(t.from,t.to)});return t(e.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}let eb=ex(!1),ew=ex(!0);function ex(e){return r=>{let{state:a,dispatch:i}=r;if(a.readOnly)return!1;let l=a.changeByRange(r=>{let{from:i,to:l}=r,s=a.doc.lineAt(i),c=!e&&i==l&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let r=(0,n.syntaxTree)(e).resolveInner(t),a=r.childBefore(t),i=r.childAfter(t),l;return a&&i&&a.to<=t&&i.from>=t&&(l=a.type.prop(o.NodeProp.closedBy))&&l.indexOf(i.name)>-1&&e.doc.lineAt(a.to).from==e.doc.lineAt(i.from).from&&!/\S/.test(e.sliceDoc(a.to,i.from))?{from:a.to,to:i.from}:null}(a,i);e&&(i=l=(l<=s.to?s:a.doc.lineAt(l)).to);let u=new n.IndentContext(a,{simulateBreak:i,simulateDoubleBreak:!!c}),d=(0,n.getIndentation)(u,i);for(null==d&&(d=(0,t.countColumn)(/^\s*/.exec(a.doc.lineAt(i).text)[0],a.tabSize));l<s.to&&/\s/.test(s.text[l-s.from]);)l++;c?{from:i,to:l}=c:i>s.from&&i<s.from+100&&!/\S/.test(s.text.slice(0,i))&&(i=s.from);let f=["",(0,n.indentString)(a,d)];return c&&f.push((0,n.indentString)(a,u.lineIndent(s.from,-1))),{changes:{from:i,to:l,insert:t.Text.of(f)},range:t.EditorSelection.cursor(i+1+f[1].length)}});return i(a.update(l,{scrollIntoView:!0,userEvent:"input"})),!0}}function eE(e,r){let n=-1;return e.changeByRange(o=>{let a=[];for(let t=o.from;t<=o.to;){let i=e.doc.lineAt(t);i.number>n&&(o.empty||o.to>i.from)&&(r(i,a,o),n=i.number),t=i.to+1}let i=e.changes(a);return{changes:a,range:t.EditorSelection.range(i.mapPos(o.anchor,1),i.mapPos(o.head,1))}})}let eC=[{key:"Ctrl-b",run:X,shift:H,preventDefault:!0},{key:"Ctrl-f",run:D,shift:J},{key:"Ctrl-p",run:_,shift:et},{key:"Ctrl-n",run:V,shift:er},{key:"Ctrl-a",run:e=>W(e,r=>t.EditorSelection.cursor(e.lineBlockAt(r.head).from,1)),shift:e=>Z(e,r=>t.EditorSelection.cursor(e.lineBlockAt(r.head).from))},{key:"Ctrl-e",run:e=>W(e,r=>t.EditorSelection.cursor(e.lineBlockAt(r.head).to,-1)),shift:e=>Z(e,r=>t.EditorSelection.cursor(e.lineBlockAt(r.head).to))},{key:"Ctrl-d",run:em},{key:"Ctrl-h",run:eh},{key:"Ctrl-k",run:e=>ed(e,t=>{let r=e.lineBlockAt(t.head).to;return t.head<r?r:Math.min(e.state.doc.length,t.head+1)})},{key:"Ctrl-Alt-h",run:eO},{key:"Ctrl-o",run:e=>{let{state:r,dispatch:n}=e;if(r.readOnly)return!1;let o=r.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t.Text.of(["",""])},range:t.EditorSelection.cursor(e.from)}));return n(r.update(o,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:e=>{let{state:r,dispatch:n}=e;if(r.readOnly)return!1;let o=r.changeByRange(e=>{if(!e.empty||0==e.from||e.from==r.doc.length)return{range:e};let n=e.from,o=r.doc.lineAt(n),a=n==o.from?n-1:(0,t.findClusterBreak)(o.text,n-o.from,!1)+o.from,i=n==o.to?n+1:(0,t.findClusterBreak)(o.text,n-o.from,!0)+o.from;return{changes:{from:a,to:i,insert:r.doc.slice(n,i).append(r.doc.slice(a,n))},range:t.EditorSelection.cursor(i)}});return!o.changes.empty&&(n(r.update(o,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:G}],eP=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:e=>W(e,t=>B(e.state,t,!M(e))),shift:e=>Z(e,t=>B(e.state,t,!M(e)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:e=>W(e,t=>B(e.state,t,M(e))),shift:e=>Z(e,t=>B(e.state,t,M(e)))},{key:"Alt-ArrowUp",run:e=>{let{state:t,dispatch:r}=e;return eS(t,r,!1)}},{key:"Shift-Alt-ArrowUp",run:e=>{let{state:t,dispatch:r}=e;return ey(t,r,!1)}},{key:"Alt-ArrowDown",run:e=>{let{state:t,dispatch:r}=e;return eS(t,r,!0)}},{key:"Shift-Alt-ArrowDown",run:e=>{let{state:t,dispatch:r}=e;return ey(t,r,!0)}},{key:"Escape",run:e=>{let{state:r,dispatch:n}=e,o=r.selection,a=null;return o.ranges.length>1?a=t.EditorSelection.create([o.main]):o.main.empty||(a=t.EditorSelection.create([t.EditorSelection.cursor(o.main.head)])),!!a&&(n(N(r,a)),!0)}},{key:"Mod-Enter",run:ew},{key:"Alt-l",mac:"Ctrl-l",run:e=>{let{state:r,dispatch:n}=e,o=ev(r).map(e=>{let{from:n,to:o}=e;return t.EditorSelection.range(n,Math.min(o+1,r.doc.length))});return n(r.update({selection:t.EditorSelection.create(o),userEvent:"select"})),!0}},{key:"Mod-i",run:e=>{let{state:r,dispatch:o}=e,a=T(r.selection,e=>{let o=(0,n.syntaxTree)(r),a=o.resolveStack(e.from,1);if(e.empty){let t=o.resolveStack(e.from,-1);t.node.from>=a.node.from&&t.node.to<=a.node.to&&(a=t)}for(let r=a;r;r=r.next){let{node:n}=r;if((n.from<e.from&&n.to>=e.to||n.to>e.to&&n.from<=e.from)&&r.next)return t.EditorSelection.range(n.to,n.from)}return e});return!a.eq(r.selection)&&(o(N(r,a)),!0)},preventDefault:!0},{key:"Mod-[",run:e=>{let{state:r,dispatch:o}=e;return!r.readOnly&&(o(r.update(eE(r,(e,o)=>{let a=/^\s*/.exec(e.text)[0];if(!a)return;let i=(0,t.countColumn)(a,r.tabSize),l=0,s=(0,n.indentString)(r,Math.max(0,i-(0,n.getIndentUnit)(r)));for(;l<a.length&&l<s.length&&a.charCodeAt(l)==s.charCodeAt(l);)l++;o.push({from:e.from+l,to:e.from+a.length,insert:s.slice(l)})}),{userEvent:"delete.dedent"})),!0)}},{key:"Mod-]",run:e=>{let{state:t,dispatch:r}=e;return!t.readOnly&&(r(t.update(eE(t,(e,r)=>{r.push({from:e.from,insert:t.facet(n.indentUnit)})}),{userEvent:"input.indent"})),!0)}},{key:"Mod-Alt-\\",run:e=>{let{state:t,dispatch:r}=e;if(t.readOnly)return!1;let o=Object.create(null),a=new n.IndentContext(t,{overrideIndentation:e=>{let t=o[e];return null==t?-1:t}}),i=eE(t,(e,r,i)=>{let l=(0,n.getIndentation)(a,e.from);if(null==l)return;/\S/.test(e.text)||(l=0);let s=/^\s*/.exec(e.text)[0],c=(0,n.indentString)(t,l);(s!=c||i.from<e.from+s.length)&&(o[e.from]=l,r.push({from:e.from,to:e.from+s.length,insert:c}))});return i.changes.empty||r(t.update(i,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:e=>{if(e.state.readOnly)return!1;let{state:t}=e,r=t.changes(ev(t).map(e=>{let{from:r,to:n}=e;return r>0?r--:n<t.doc.length&&n++,{from:r,to:n}})),n=T(t.selection,t=>{let r;if(e.lineWrapping){let n=e.lineBlockAt(t.head),o=e.coordsAtPos(t.head,t.assoc||1);o&&(r=n.bottom+e.documentTop-o.bottom+e.defaultLineHeight/2)}return e.moveVertically(t,!0,r)}).map(r);return e.dispatch({changes:r,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:e=>{let{state:r,dispatch:o}=e;return function(e,r,o){let a=!1,i=T(e.selection,r=>{let i=(0,n.matchBrackets)(e,r.head,-1)||(0,n.matchBrackets)(e,r.head,1)||r.head>0&&(0,n.matchBrackets)(e,r.head-1,1)||r.head<e.doc.length&&(0,n.matchBrackets)(e,r.head+1,-1);if(!i||!i.end)return r;a=!0;let l=i.start.from==r.head?i.end.to:i.end.from;return o?t.EditorSelection.range(r.anchor,l):t.EditorSelection.cursor(l)});return!!a&&(r(N(e,i)),!0)}(r,o,!1)}},{key:"Mod-/",run:e=>{let{state:t}=e,r=t.doc.lineAt(t.selection.main.from),n=c(e.state,r.from);return n.line?i(e):!!n.block&&s(e)}},{key:"Alt-A",run:l},{key:"Ctrl-m",mac:"Shift-Alt-m",run:e=>(e.setTabFocusMode(),!0)}].concat([{key:"ArrowLeft",run:X,shift:H,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:e=>j(e,!M(e)),shift:e=>K(e,!M(e)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:e=>W(e,t=>Y(e,t,!M(e))),shift:e=>Z(e,t=>Y(e,t,!M(e))),preventDefault:!0},{key:"ArrowRight",run:D,shift:J,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:e=>j(e,M(e)),shift:e=>K(e,M(e)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:e=>W(e,t=>Y(e,t,M(e))),shift:e=>Z(e,t=>Y(e,t,M(e))),preventDefault:!0},{key:"ArrowUp",run:_,shift:et,preventDefault:!0},{mac:"Cmd-ArrowUp",run:ei,shift:es},{mac:"Ctrl-ArrowUp",run:U,shift:eo},{key:"ArrowDown",run:V,shift:er,preventDefault:!0},{mac:"Cmd-ArrowDown",run:el,shift:ec},{mac:"Ctrl-ArrowDown",run:G,shift:ea},{key:"PageUp",run:U,shift:eo},{key:"PageDown",run:G,shift:ea},{key:"Home",run:e=>W(e,t=>Y(e,t,!1)),shift:e=>Z(e,t=>Y(e,t,!1)),preventDefault:!0},{key:"Mod-Home",run:ei,shift:es},{key:"End",run:e=>W(e,t=>Y(e,t,!0)),shift:e=>Z(e,t=>Y(e,t,!0)),preventDefault:!0},{key:"Mod-End",run:el,shift:ec},{key:"Enter",run:eb,shift:eb},{key:"Mod-a",run:eu},{key:"Backspace",run:eh,shift:eh},{key:"Delete",run:em},{key:"Mod-Backspace",mac:"Alt-Backspace",run:eO},{key:"Mod-Delete",mac:"Alt-Delete",run:e=>eg(e,!0)},{mac:"Mod-Backspace",run:e=>ed(e,t=>{let r=e.moveToLineBoundary(t,!1).head;return t.head>r?r:Math.max(0,t.head-1)})},{mac:"Mod-Delete",run:e=>ed(e,t=>{let r=e.moveToLineBoundary(t,!0).head;return t.head<r?r:Math.min(e.state.doc.length,t.head+1)})}].concat(eC.map(e=>({mac:e.key,run:e.run,shift:e.shift}))))},224203,e=>{"use strict";e.s(["lintKeymap",()=>m]);var t=e.i(334283),r=e.i(650218),n=e.i(141016);class o{constructor(e,t,r){this.from=e,this.to=t,this.diagnostic=r}}class a{static init(e,n,o){let l=o.facet(g).markerFilter;l&&(e=l(e,o));let s=e.slice().sort((e,t)=>e.from-t.from||e.to-t.to),c=new r.RangeSetBuilder,u=[],d=0;for(let e=0;;){let r,n,a=e==s.length?null:s[e];if(!a&&!u.length)break;for(u.length?(r=d,n=u.reduce((e,t)=>Math.min(e,t.to),a&&a.from>r?a.from:1e8)):(r=a.from,n=a.to,u.push(a),e++);e<s.length;){let t=s[e];if(t.from==r&&(t.to>t.from||t.to==r))u.push(t),e++,n=Math.min(t.to,n);else{n=Math.min(t.from,n);break}}let i=E(u);if(u.some(e=>e.from==e.to||e.from==e.to-1&&o.doc.lineAt(e.from).to==e.from))c.add(r,r,t.Decoration.widget({widget:new S(i),diagnostics:u.slice()}));else{let e=u.reduce((e,t)=>t.markClass?e+" "+t.markClass:e,"");c.add(r,n,t.Decoration.mark({class:"cm-lintRange cm-lintRange-"+i+e,diagnostics:u.slice(),inclusiveEnd:u.some(e=>e.to>n)}))}d=n;for(let e=0;e<u.length;e++)u[e].to<=d&&u.splice(e--,1)}let f=c.finish();return new a(f,n,i(f))}constructor(e,t,r){this.diagnostics=e,this.panel=t,this.selected=r}}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=null;return e.between(r,1e9,(e,r,a)=>{let{spec:i}=a;if(!(t&&0>i.diagnostics.indexOf(t)))if(n){if(0>i.diagnostics.indexOf(n.diagnostic))return!1;n=new o(n.from,r,n.diagnostic)}else n=new o(e,r,t||i.diagnostics[0])}),n}function l(e,t){let r=t.pos,n=t.end||r,o=e.state.facet(g).hideOn(e,r,n);if(null!=o)return o;let a=e.startState.doc.lineAt(t.pos);return!!(e.effects.some(e=>e.is(s))||e.changes.touchesRange(a.from,Math.max(a.to,n)))}let s=r.StateEffect.define(),c=r.StateEffect.define(),u=r.StateEffect.define(),d=r.StateField.define({create:()=>new a(t.Decoration.none,null,null),update(e,t){if(t.docChanged&&e.diagnostics.size){let r=e.diagnostics.map(t.changes),n=null,o=e.panel;if(e.selected){let o=t.changes.mapPos(e.selected.from,1);n=i(r,e.selected.diagnostic,o)||i(r,null,o)}!r.size&&o&&t.state.facet(g).autoPanel&&(o=null),e=new a(r,o,n)}for(let r of t.effects)if(r.is(s)){let n=t.state.facet(g).autoPanel?r.value.length?b.open:null:e.panel;e=a.init(r.value,n,t.state)}else r.is(c)?e=new a(e.diagnostics,r.value?b.open:null,e.selected):r.is(u)&&(e=new a(e.diagnostics,e.panel,r.value));return e},provide:e=>[t.showPanel.from(e,e=>e.panel),t.EditorView.decorations.from(e,e=>e.diagnostics)]}),f=t.Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function p(e,t){return(0,n.default)("ul",{class:"cm-tooltip-lint"},t.map(t=>v(e,t,!1)))}let h=e=>{let t=e.state.field(d,!1);return!!t&&!!t.panel&&(e.dispatch({effects:c.of(!1)}),!0)},m=[{key:"Mod-Shift-m",run:e=>{let n=e.state.field(d,!1);n&&n.panel||e.dispatch({effects:function(e,t){return e.field(d,!1)?t:t.concat(r.StateEffect.appendConfig.of(k))}(e.state,[c.of(!0)])});let o=(0,t.getPanel)(e,b.open);return o&&o.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:e=>{let t=e.state.field(d,!1);if(!t)return!1;let r=e.state.selection.main,n=t.diagnostics.iter(r.to+1);return(!!n.value||!!(n=t.diagnostics.iter(0)).value&&(n.from!=r.from||n.to!=r.to))&&(e.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)}}],g=r.Facet.define({combine:e=>Object.assign({sources:e.map(e=>e.source).filter(e=>null!=e)},(0,r.combineConfig)(e.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?r=>e(r)||t(r):e:t}))});function O(e){let t=[];if(e)e:for(let{name:r}of e){for(let e=0;e<r.length;e++){let n=r[e];if(/[a-zA-Z]/.test(n)&&!t.some(e=>e.toLowerCase()==n.toLowerCase())){t.push(n);continue e}}t.push("")}return t}function v(e,t,r){var o;let a=r?O(t.actions):[];return(0,n.default)("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},(0,n.default)("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(e):t.message),null==(o=t.actions)?void 0:o.map((r,o)=>{let l=!1,s=n=>{if(n.preventDefault(),l)return;l=!0;let o=i(e.state.field(d).diagnostics,t);o&&r.apply(e,o.from,o.to)},{name:c}=r,u=a[o]?c.indexOf(a[o]):-1,f=u<0?c:[c.slice(0,u),(0,n.default)("u",c.slice(u,u+1)),c.slice(u+1)];return(0,n.default)("button",{type:"button",class:"cm-diagnosticAction",onclick:s,onmousedown:s,"aria-label":" Action: ".concat(c).concat(u<0?"":' (access key "'.concat(a[o],')"'),".")},f)}),t.source&&(0,n.default)("div",{class:"cm-diagnosticSource"},t.source))}class S extends t.WidgetType{eq(e){return e.sev==this.sev}toDOM(){return(0,n.default)("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}constructor(e){super(),this.sev=e}}class y{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(0xffffffff*Math.random()).toString(16),this.dom=v(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class b{get selectedIndex(){let e=this.view.state.field(d).selected;if(!e)return -1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return -1}update(){let{diagnostics:e,selected:t}=this.view.state.field(d),r=0,n=!1,o=null,a=new Set;for(e.between(0,this.view.state.doc.length,(e,i,l)=>{let{spec:s}=l;for(let e of s.diagnostics){if(a.has(e))continue;a.add(e);let i=-1,l;for(let t=r;t<this.items.length;t++)if(this.items[t].diagnostic==e){i=t;break}i<0?(l=new y(this.view,e),this.items.splice(r,0,l),n=!0):(l=this.items[i],i>r&&(this.items.splice(r,i-r),n=!0)),t&&l.diagnostic==t.diagnostic?l.dom.hasAttribute("aria-selected")||(l.dom.setAttribute("aria-selected","true"),o=l):l.dom.hasAttribute("aria-selected")&&l.dom.removeAttribute("aria-selected"),r++}});r<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();0==this.items.length&&(this.items.push(new y(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),o?(this.list.setAttribute("aria-activedescendant",o.id),this.view.requestMeasure({key:this,read:()=>({sel:o.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:e=>{let{sel:t,panel:r}=e,n=r.height/this.list.offsetHeight;t.top<r.top?this.list.scrollTop-=(r.top-t.top)/n:t.bottom>r.bottom&&(this.list.scrollTop+=(t.bottom-r.bottom)/n)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling,t.remove()}for(let r of this.items)if(r.dom.parentNode==this.list){for(;e!=r.dom;)t();e=r.dom.nextSibling}else this.list.insertBefore(r.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=i(this.view.state.field(d).diagnostics,this.items[e].diagnostic);t&&this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:u.of(t)})}static open(e){return new b(e)}constructor(e){this.view=e,this.items=[];let t=t=>{if(27==t.keyCode)h(this.view),this.view.focus();else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else{if(!(t.keyCode>=65)||!(t.keyCode<=90)||!(this.selectedIndex>=0))return;let{diagnostic:r}=this.items[this.selectedIndex],n=O(r.actions);for(let o=0;o<n.length;o++)if(n[o].toUpperCase().charCodeAt(0)==t.keyCode){let t=i(this.view.state.field(d).diagnostics,r);t&&r.actions[o].apply(e,t.from,t.to)}}t.preventDefault()},r=e=>{for(let t=0;t<this.items.length;t++)this.items[t].dom.contains(e.target)&&this.moveSelection(t)};this.list=(0,n.default)("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:r}),this.dom=(0,n.default)("div",{class:"cm-panel-lint"},this.list,(0,n.default)("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>h(this.view)},"×")),this.update()}}function w(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:'viewBox="0 0 40 40"';return'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" '.concat(t,">").concat(encodeURIComponent(e),"</svg>')")}('<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="'.concat(e,'" fill="none" stroke-width=".7"/>'),'width="6" height="3"')}let x=t.EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:w("#d11")},".cm-lintRange-warning":{backgroundImage:w("orange")},".cm-lintRange-info":{backgroundImage:w("#999")},".cm-lintRange-hint":{backgroundImage:w("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function E(e){let t="hint",r=1;for(let o of e){var n;let e="error"==(n=o.severity)?4:"warning"==n?3:"info"==n?2:1;e>r&&(r=e,t=o.severity)}return t}t.GutterMarker;let C=r.StateEffect.define(),P=r.StateField.define({create:()=>null,update:(e,t)=>(e&&t.docChanged&&(e=l(t,e)?null:Object.assign(Object.assign({},e),{pos:t.changes.mapPos(e.pos)})),t.effects.reduce((e,t)=>t.is(C)?t.value:e,e)),provide:e=>t.showTooltip.from(e)}),k=[d,t.EditorView.decorations.compute([d],e=>{let{selected:r,panel:n}=e.field(d);return r&&n&&r.from!=r.to?t.Decoration.set([f.range(r.from,r.to)]):t.Decoration.none}),(0,t.hoverTooltip)(function(e,t,r){let{diagnostics:n}=e.state.field(d),o,a=-1,i=-1;n.between(t-(r<0),t+ +(r>0),(e,n,l)=>{let{spec:s}=l;if(t>=e&&t<=n&&(e==n||(t>e||r>0)&&(t<n||r<0)))return o=s.diagnostics,a=e,i=n,!1});let l=e.state.facet(g).tooltipFilter;return(o&&l&&(o=l(o,e.state)),o)?{pos:a,end:i,above:e.state.doc.lineAt(a).to<i,create:()=>({dom:p(e,o)})}:null},{hideOn:l}),x],Q=r.Facet.define({combine:e=>(0,r.combineConfig)(e,{hoverTime:300,markerFilter:null,tooltipFilter:null})})},837433,e=>{"use strict";e.s(["basicSetup",()=>c,"monoFontFamily",()=>d,"sansFontFamily",()=>u,"singleLineSetup",()=>l]);var t=e.i(874838),r=e.i(162284),n=e.i(255791),o=e.i(224203),a=e.i(650218),i=e.i(334283);let l=[a.EditorState.transactionFilter.of(e=>e.newDoc.lines>1?[e,{changes:{from:0,to:e.newDoc.length,insert:e.newDoc.sliceString(0,void 0," ").trim()},sequential:!0}]:[e])];(0,i.lineNumbers)(),(0,i.highlightActiveLine)(),(0,i.highlightActiveLineGutter)(),(0,n.foldGutter)();let s=[{key:"Tab",run:t.acceptCompletion,stopPropagation:!0},{key:"Enter",run:t.acceptCompletion,stopPropagation:!0},{key:"Escape",run:t.closeCompletion,stopPropagation:!0}],c=[(0,r.history)(),(0,i.highlightSpecialChars)(),(0,i.drawSelection)(),(0,i.dropCursor)(),a.EditorState.allowMultipleSelections.of(!0),(0,n.indentOnInput)(),(0,n.syntaxHighlighting)(n.defaultHighlightStyle,{fallback:!0}),(0,n.bracketMatching)(),(0,t.closeBrackets)(),(0,t.autocompletion)({icons:!1}),(0,i.rectangularSelection)(),(0,i.crosshairCursor)(),i.keymap.of([...t.closeBracketsKeymap,...r.defaultKeymap.filter(e=>"Enter"!==e.key),...r.historyKeymap,...n.foldKeymap,...t.completionKeymap,...s,...o.lintKeymap])];i.EditorView.updateListener.of(e=>{let{docChanged:r,view:n,state:o}=e,a=(r||n.hasFocus)&&!(0,t.completionStatus)(o);!o.doc.length&&a&&(0,t.startCompletion)(n)});let u=i.EditorView.theme({"& .cm-scroller":{fontFamily:"var(--cm-sans-font, inherit) !important"}}),d=i.EditorView.theme({"& .cm-scroller":{fontFamily:"var(--cm-mono-font, inherit) !important"}})},116132,e=>{"use strict";e.s(["FormulaTextEditor",()=>ez,"default",()=>eF,"formulaEditorProvider",()=>eV],116132);var t,r,n=e.i(628925),o=e.i(162284),a=e.i(650218),i=e.i(334283),l=e.i(140578),s=e.i(211959),c=e.i(596222),u=e.i(837433),d=e.i(406845),f=e.i(476238),p=e.i(255791),h=e.i(380495),m=e.i(935777);e.s(["ArgList",()=>Y,"Argument",()=>Z,"ArrayColumns",()=>K,"ArrayConstant",()=>et,"ArrayRows",()=>ee,"BoolToken",()=>x,"BuiltInFunctionName",()=>y,"CellToken",()=>R,"CloseParen",()=>X,"ColRangeToken",()=>T,"CompareOp",()=>H,"Constant",()=>V,"ConstantArray",()=>J,"ErrorToken",()=>w,"Formula",()=>P,"FormulaInfixOp",()=>$,"FormulaWithEq",()=>C,"FunctionCall",()=>U,"FunctionName",()=>G,"MultipleSheetsQuotedToken",()=>_,"MultipleSheetsToken",()=>z,"NameToken",()=>A,"Number",()=>F,"OpenParen",()=>I,"Quote",()=>j,"RangeToken",()=>q,"RefErrorToken",()=>b,"Reference",()=>k,"ReferenceFunctionCall",()=>W,"ReferenceItem",()=>Q,"RowRangeToken",()=>N,"Script",()=>E,"Separator",()=>O,"SheetQuotedToken",()=>B,"SheetToken",()=>D,"TextToken",()=>L,"Union",()=>M,"arrayRowSeparator",()=>S,"decimalSeparator",()=>v,"intersecop",()=>g],696423);let g=48,O=1,v=49,S=50,y=2,b=3,w=4,x=5,E=6,C=7,P=8,k=9,Q=10,R=11,A=12,T=13,N=14,W=15,q=16,I=17,M=18,X=19,D=20,j=21,B=22,z=23,_=24,V=25,F=26,L=27,U=28,G=29,Y=30,Z=31,$=32,H=37,J=38,K=39,ee=40,et=41;var er=e.i(696423),en=e.i(865125);let eo=new Set([9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288]),ea=e=>e>=65&&e<=90||e>=97&&e<=122,ei=e=>e>=48&&e<=57,el=e=>eo.has(e),es=new m.ExternalTokenizer(e=>{let{next:t}=e;if(!el(t))return;let r=e.peek(-1);if(ei(r)||ea(r)||41===r||92===r||95===r||46===r||63===r||8364===r){do t=e.advance();while(el(t))if(ea(t)||ei(t)||40===t||92===t||95===t)return e.acceptToken(er.intersecop)}},{contextual:!0}),ec={".":46,",":44};function eu(e){return new m.ExternalTokenizer(t=>{if(t.next===ec[e])return t.acceptToken(er.decimalSeparator,1)})}let ed={".":44,",":59};function ef(e){return new m.ExternalTokenizer(t=>{if(t.next===ed[e])return t.acceptToken(er.Separator,1)})}let ep={".":",",",":"\\"};function eh(e){return t=>t===ep[e]?er.arrayRowSeparator:-1}let em=eu("."),eg=ef("."),eO=eh("."),ev=function(e){return t=>e.refError.includes(t.toUpperCase())?er.RefErrorToken:e.error.includes(t.toUpperCase())?er.ErrorToken:-1}(en.default),eS=(t=en.default,e=>t.bool.includes(e.toUpperCase())?er.BoolToken:-1),ey=(r=en.default,e=>r.formulas[e.toUpperCase()]?er.BuiltInFunctionName:-1),eb=m.LRParser.deserialize({version:14,states:"0nO!dQ[OOOOQR'#Cf'#CfO#uQcO'#CfO$wQaO'#CdOOQR'#Ck'#CkO%UQ[O'#CdOOQO'#Dg'#DgO%`QpO'#DgOOQR'#Ce'#CeO%hQWO'#CeOOQU'#DX'#DXO&hQdO'#CvO&xQWO'#CvOOQQ'#Cu'#CuO'iQ`O'#DcO'pQ`O'#CxO%XQ[O'#CxOOQQ'#Cx'#CxO(dQ[O'#DSOOQQ'#Cd'#CdO(kQ[O'#CcOOQO'#Dc'#DcQOQWOOO(uQWO,59WO(uQWO,59VOOQR,59V,59VO)dQcO,59PO)nQWO,59VO)sQ`O,59OO'uQ[O'#DSOOQQ,59O,59OOOQO,5:R,5:ROOQR,59P,59POOQU-E7V-E7VO*iQ`O,59bOOQQ,59b,59bOOQS'#C}'#C}OOQS'#DO'#DOOOQS'#DP'#DPOOQS'#DQ'#DQO%XQ[O,59hO%XQ[O,59hO%XQ[O,59hO%XQ[O,59hO%XQ[O,59hOOQQ,59d,59dO*vQ!hO'#CzO,^Q`O,59dO,kQ[O'#CvOOQS'#Dv'#DvOOQO'#DV'#DVO,|Q[O'#DVO-UQWO'#DUO-aQWO'#DTO-iQWO,59nO%XQ[O,5:eO-nQ`O,58}OOQR1G.r1G.rO-uQWO'#CkO/XQcO1G.qO-uQWO'#DWO/iQYO,59YOOQR1G.k1G.kOOQR1G.q1G.qOOQQ1G.j1G.jO0`Q`O1G.|O1_Q`O1G/SO2TQ`O1G/SO2_Q`O1G/SO3WQ`O1G/SO3_Q`O1G/SO3fQ#wO'#CfO3mQ#wO'#CdO4hQ#zO'#CvO5aQ#vO'#C{O5kQ!dO,59fO5sQWO,59bOOQO,59q,59qO'uQ[O'#DZO6RQWO,59pO6^QWO,59oO'uQ[O'#D[OOQQ1G/Y1G/YO6fQ`O1G0PO6mQZO'#CfO7_QZO,59PO7pQZO,59rOOQQ-E7U-E7UO8RQ#vO,59bO*vQ!hO'#DYO8]Q!dO1G/QOOQQ1G/Q1G/QO8eQ#vO,59dO8oQWO1G.|OOQO,59u,59uOOQO-E7X-E7XOOQO-E7Y-E7YOOQO,59v,59vOOQO7+%k7+%kO8}Q#wO1G.qO9XQ#vO1G.|O:QQ#vO1G/SO:sQ#vO1G/SO:}Q#vO1G/SO;sQ#vO1G/SO;zQ#vO1G/SOOQQ,59t,59tOOQQ-E7W-E7WOOQQ7+$l7+$lO<RQZO1G.qO<dQ[O'#CxO=tQWO,59WO-uQWO,59WO=tQWO,59VO-uQWO,59VO<dQ[O,59hO<dQ[O,59hO<dQ[O,59hO<dQ[O,59hO<dQ[O,59h",stateData:">v~O!UOS~OQ_ORQOS]OT]OZPO[PO]PO^POaTOdUOeVOgUOk]Om_O!R[O![YO!_`O!``O!a`O~O!WdO!ibO~PVOR!ZXZ!ZX[!ZX]!ZX^!ZXuYX!QYX!XYX!YYX!bYX!cYX!dYX!eYX!fYX!gYX!hYXPYX~O!PYXcYX!lYX~P!nO!QhO!XgO!YiOuWX!bWX!cWX!dWX!eWX!fWX!gWX!hWX~O!PWXcWX!lWX~P$SOcnO!imO~PVOfoOhoO~ORPOZPO[PO]PO^PO~O![YOujX!bjX!cjX!djX!ejX!fjX!gjX!hjX~O!RrO!PjXcjX!ljX~P%yO![sO~Ou|O!b}O!ctO!duO!euO!fvO!gvO!hwO~O!P!VX~P&}O!]!OO~OR!SOS]OT]Ok]O!R[O![YO!_!RO!`!RO!a!RO~O!W!XO~P'uO!imO!PVX~PVORQOZPO[PO]PO^POa![OdUOeVOgUO~OP!^Oc!`O~P$SOc!aO~Oc!bO~P&}O![YOuja!bja!cja!dja!eja!fja!gja!hja~O!Pjacja!lja~P)zOQ_OR!iOS]OT]OZPO[PO]PO^POaTOdUOeVOgUOk]Om_O!R[O![YO!_#bO!`#bO!a#bO!imOPoP!^oP~O!Placla!lla~P&}O!R!nO![YO!SjX!kjX!ljX~O!R[O![YO~O!S!pO!kxX!lxX~O!k!sO!lwX~O!l!tO~O!PVa~P&}OR!vOZPO[PO]PO^POa![OdUOeVOgUO~Ou_i!Q_i!Y_i!b_i!c_i!d_i!e_i!f_i!g_i!h_iP_i~O!XgO!P_ic_i!l_i~P.dOP!^Ocba~O![YOuji!bji!cji!dji!eji!fji!gji!hji~O!Pjicji!lji~P/qO!b}Oupi!Ppi!dpi!epi!fpi!gpi!hpicpi!lpi~O!cpi~P0mO!b}O!ctOupi!Ppi!dpi!epi!hpicpi!lpi~O!fvO!gvO~P1fO!ctO~P0mO!b}O!ctO!duO!euO!fvO!gvOupi!Ppicpi!lpi~O!hpi~P2fO!hwO~P2fO!^YX~P!nO!Q#eO!X#cO!YiOPWXuWX!^WX!bWX!cWX!dWX!eWX!fWX!gWX!hWX~O!R!zOPjX!^jX~P%yOu#kO!b}O!ctO!duO!euO!fvO!gvO!hwO~OPoX!^oX~P4uOP!{O!^!}O~O![YO!Sja!kja!lja~O!S!pO!kxa!lxa~O!k!sO!lwa~O!l#UO~P&}OPYXR!ZXZ!ZX[!ZX]!ZX^!ZXcYX!QYX!XYX!YYX~OP!^Oc!`O!Q#fO!X#dO!YiO~O!Q#fO!X#dO!YiOPzacza~OPja!^ja~P)zOP!{O!^#`O~OPla!^la~P4uO![YO!Sji!kji!lji~O!X#cO!^_i~P.dOPji!^ji~P/qO!b}OPpiupi!^pi!dpi!epi!fpi!gpi!hpi~O!cpi~P9cO!b}O!ctOPpiupi!^pi!dpi!epi!hpi~O!fvO!gvO~P:XO!ctO~P9cO!b}O!ctO!duO!euO!fvO!gvOPpiupi!^pi~O!hpi~P;UO!hwO~P;UO!X#dOP_ic_i!Q_i!Y_i~OQ_OR!iOS]OT]OZPO[PO]PO^POaTOdUOeVOgUOk]Om_O!R[O![YO!_#bO!`#bO!a#bO!imO~OR!iOZPO[PO]PO^POa![OdUOeVOgUO~O^hfgkd![]Z!nm[!o!Y!a!_!UZ~",goto:"-W!nPPPPPPP!o!r#x$vPPPP%g&TP&qPPPPPP&u'aP'|P(b(e(k)P)d)s*UP'|*c*g*n*v*}+},T,ZPPPPPP,aPPP,dPPPPPPPPPPPPPP-QPP!oReOQ^OQlTQ!P`Q!YdQ!dxQ!eyQ!fzQ!g{Q!h|S!l!O!{Q!u!XQ#O#bQ#X#gQ#Y#hQ#Z#iQ#[#jR#]#kbRO`dxyz{|!XQjTU!Zg#c#dQ!]h`!j!O!{#b#g#h#i#j#kQ!w![Q!x!^Q#V#eR#a#f!UWOT`dghxyz{|!O!X![!^!{#b#c#d#e#f#g#h#i#j#kRpX!VWOT`dghxyz{|!O!X![!^!{#b#c#d#e#f#g#h#i#j#k!VSOT`dghxyz{|!O!X![!^!{#b#c#d#e#f#g#h#i#j#kTkT![tcOT`dxyz{|!O!X!{#b#g#h#i#j#kX!Sbm!p!s|]OT`bdmxyz{|!O!X!p!s!{#b#g#h#i#j#kR!o!TucOT`dxyz{|!O!X!{#b#g#h#i#j#kR}_Q!m!OR#^!{uaOT`dxyz{|!O!X!{#b#g#h#i#j#kbx^l!P!Y!e!f!g!h!u]#g!l#O#Y#Z#[#]^y^l!P!Y!g!h!uX#h!l#O#[#]`z^l!P!Y!e!g!h!uZ#i!l#O#Y#[#][{^l!P!Y!h!uV#j!l#O#]T!WbmS!VbmR#T!sU!Ubm!sR#Q!pS!_j!wR!y!_dZOT`dxyz{|!X[qZ!Q!c!k#P#WY!Qbm!T!p!sQ!cr`!k!O!{#b#g#h#i#j#kQ#P!nR#W!zQ!|!mR#_!|Q!q!UR#R!qQ!r!VR#S!rRfO!VXOT`dghxyz{|!O!X![!^!{#b#c#d#e#f#g#h#i#j#kX!Tbm!p!s",nodeNames:"⚠ Separator BuiltInFunctionName RefErrorToken ErrorToken BoolToken Script FormulaWithEq Formula Reference ReferenceItem CellToken NameToken ColRangeToken RowRangeToken ReferenceFunctionCall RangeToken OpenParen Union CloseParen SheetToken Quote SheetQuotedToken MultipleSheetsToken MultipleSheetsQuotedToken Constant Number TextToken FunctionCall FunctionName ArgList Argument FormulaInfixOp ArithOp ArithOp ArithOp ArithOp CompareOp ConstantArray ArrayColumns ArrayRows ArrayConstant",maxTerm:77,nodeProps:[["closedBy",17,"CloseParen"],["openedBy",19,"OpenParen"]],skippedNodes:[0],repeatNodeCount:5,tokenData:"#(W~RyOX#rXY/XYZ/XZ]#r]^/X^p#rpq1Xqr#rrs2fstHetuK_uv!6[vw!7Swx!7zxy!8Syz!8|z{!9v{|!9{|}!;n}!O!<f!O!P#r!P!Q!=`!Q![!=e![!]!?U!]!^!?Z!^!_!@R!_!`!Aw!`!a!Bq!b!c!Co!c!}!E`#O#P#%P#Q#R#%p#R#S!Gh#S#T#r#T#o!E`#o#p#&h#p#q#r#q#r#'`#r;'S#r;'S;=`/R<%lO#r]#uhOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#rS%dZOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aS&YQqr&`wx%aS&eOfSS&hYOw'Wwx(_xz'W{!P'W!Q!['W!]!a'W!b!}'W#Q;'S'W;'S;=`(X<%lO'WS'ZYOw'Wwx'yxz'W{!P'W!Q!['W!]!a'W!b!}'W#Q;'S'W;'S;=`(X<%lO'WS'|Qqr(Swx'WS(XOhSS([P;=`<%l'WS(bPwx'WS(hP;=`<%l%a](phdXOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r]*_fOp+spq'Wqs+sst'Wtu+suw'Wwx(_xz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s]+vgOp+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s]-dggXOp+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s]/OP;=`<%l+s]/UP;=`<%l#r~/^m!U~OX#rXY/XYZ/XZ]#r]^/X^p#rpq1Xqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~1^b!U~OX%aXY1XYZ1XZ]%a]^1X^p%apq1Xqw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~2ilOp2fpq4aqr=[rs?Xst4atu2fuw4awx6gxz4az{7S{|2f|!O4a!O!P2f!P!Q7S!Q![2f![!]@x!]!a4a!a!b7S!b!}2f!}#Q7S#Q#R4a#R#o2f#o#p4a#p#q2f#q#r4a#r;'S2f;'S;=`H_<%lO2f~4daOr4ars5isw4awx6gxz4az{7S{!P4a!P!Q7S!Q![4a![!]8Y!]!a4a!a!b7S!b!}4a!}#Q7S#Q;'S4a;'S;=`=U<%lO4a~5n]k~Or%ars4asw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~6jWOq7Sqr7trs7fsw7Swx4ax;'S7S;'S;=`7n<%lO7S~7VTOr7Srs7fs;'S7S;'S;=`7n<%lO7S~7kPk~rs7S~7qP;=`<%l7S~7yTfSOr7Srs7fs;'S7S;'S;=`7n<%lO7S~8]aOr9brs:jsw9bwx<lxz9bz{7S{!P9b!P!Q7S!Q![9b![!]7S!]!a9b!a!b7S!b!}9b!}#Q7S#Q;'S9b;'S;=`<f<%lO9b~9eaOr9brs:jsw9bwx;exz9bz{7S{!P9b!P!Q7S!Q![9b![!]7S!]!a9b!a!b7S!b!}9b!}#Q7S#Q;'S9b;'S;=`<f<%lO9b~:o[k~Or'Wrs9bsw'Wwx'yxz'W{!P'W!Q!['W!]!a'W!b!}'W#Q;'S'W;'S;=`(X<%lO'W~;hWOq7Sqr<Qrs7fsw7Swx9bx;'S7S;'S;=`7n<%lO7S~<VThSOr7Srs7fs;'S7S;'S;=`7n<%lO7S~<iP;=`<%l9b~<oVOr7Srs7fsw7Swx9bx;'S7S;'S;=`7n<%lO7S~=XP;=`<%l4a~=aldXOp2fpq4aqr=[rs?Xst4atu2fuw4awx6gxz4az{7S{|2f|!O4a!O!P2f!P!Q7S!Q![2f![!]@x!]!a4a!a!b7S!b!}2f!}#Q7S#Q#R4a#R#o2f#o#p4a#p#q2f#q#r4a#r;'S2f;'S;=`H_<%lO2f~?^hk~Op#rpq%aqr(krs2fst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~@{lOpBspq9bqrBsrsFkst9btuBsuw9bwx<lxz9bz{7S{|Bs|!O9b!O!PBs!P!Q7S!Q![Bs![!]7S!]!a9b!a!b7S!b!}Bs!}#Q7S#Q#R9b#R#oBs#o#p9b#p#qBs#q#r9b#r;'SBs;'S;=`HX<%lOBs~BvlOpBspq9bqrDnrsFkst9btuBsuw9bwx;exz9bz{7S{|Bs|!O9b!O!PBs!P!Q7S!Q![Bs![!]7S!]!a9b!a!b7S!b!}Bs!}#Q7S#Q#R9b#R#oBs#o#p9b#p#qBs#q#r9b#r;'SBs;'S;=`HX<%lOBs~DslgXOpBspq9bqrDnrsFkst9btuBsuw9bwx;exz9bz{7S{|Bs|!O9b!O!PBs!P!Q7S!Q![Bs![!]7S!]!a9b!a!b7S!b!}Bs!}#Q7S#Q#R9b#R#oBs#o#p9b#p#qBs#q#r9b#r;'SBs;'S;=`HX<%lOBs~Fpgk~Op+spq'Wqr-_rsBsst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~H[P;=`<%lBs~HbP;=`<%l2f~Hj[!Y~Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!c%a!c!}I`#Q;'S%a;'S;=`(e<%lO%a~Ied!o~Oq%aqrI`rw%awx&Vxz%a{!P%a!P!QJs!Q![I`![!]&e!]!a%a!a!bJs!b!c%a!c!}I`#Q#R%a#R#SI`#S%r%a%r%sI`%s;'S%a;'S;=`(e<%lO%a~JxV!o~qrJs!P!QJs!Q![Js!a!bJs!c!}Js#R#SJs%r%sJs~KbjOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![MS![!]*[!]!a%a!b!c#r!c!}!%b#Q#R%a#R#T#r#T#o!%b#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~MVhOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![MS![!]Nq!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~NtfOp+spq'Wqs+sst'Wtu!!Yuw'Wwx(_xz'W{|+s|!O'W!O!P+s!Q![!#t!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!!]gOp+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![!#t!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!#yg^~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![!#t!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!%ejOp#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!(t![!]!*e!]!a%a!b!c#r!c!}!2x#Q#R%a#R#T#r#T#o!2x#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!'YhOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!(t![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!(yhZ~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!(t![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!*hhOp+spq'Wqs+sst'Wtu!,Suw'Wwx(_xz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!-t#Q#R'W#R#T+s#T#o!-t#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!,ViOp+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!-t#Q#R'W#R#T+s#T#o!-t#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!-yi]~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!/h#Q#R'W#R#T+s#T#o!/h#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!/mi]~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!1[#Q#R'W#R#T+s#T#o!1[#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!1ag]~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!2{jOp#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!(t![!]!*e!]!a%a!b!c#r!c!}!4m#Q#R%a#R#T#r#T#o!4m#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!4phOp#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!(t![!]!*e!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#rf!6aZ!bbOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%af!7XZ!hbOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a]!8PPeXwx%a_!8ZZ!]QaXOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%ao!9TZ!^hcROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~!9{O!f~o!:Sh!db!_XOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!;sZ!n~Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%ao!<mZ!eb!`XOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~!=eO!g~~!=jh![~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!=e![!]Nq!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!?ZO!X~T!?`Z!kPOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%af!@W]ubOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!_%a!_!`!AP!`!a!AP!b!}%a#Q;'S%a;'S;=`(e<%lO%af!AUZubOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%ag!BOZub!WPOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%af!Bv]ubOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!_%a!_!`!AP!`!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~!Cth!a~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!Egom~[~Op#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P!Gh!Q![!Le![!]!*e!]!a%a!a!b!Ip!b!c#r!c!}!No#O#P!Ip#Q#R%a#R#S!Gh#S#T#r#T#o!No#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~!Goom~[~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P!Gh!Q![!Gh![!]*[!]!a%a!a!b!Ip!b!c#r!c!}!Gh#O#P!Ip#Q#R%a#R#S!Gh#S#T#r#T#o!Gh#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~!IuW[~!O!P!Ip!Q![!Ip!a!b!Ip!c!}!Ip#O#P!Ip#R#S!Ip#T#o!Ip$Lv$Lw!Ip~!Jdo[~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P!J_!Q![!J_![!]*[!]!a%a!a!b!Ip!b!c#r!c!}!J_#O#P!Ip#Q#R%a#R#S!J_#S#T#r#T#o!J_#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~!LnoZ~m~[~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P!Gh!Q![!Le![!]*[!]!a%a!a!b!Ip!b!c#r!c!}!Gh#O#P!Ip#Q#R%a#R#S!Gh#S#T#r#T#o!Gh#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~!Nvom~[~Op#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P!Gh!Q![!Le![!]!*e!]!a%a!a!b!Ip!b!c#r!c!}#!w#O#P!Ip#Q#R%a#R#S!Gh#S#T#r#T#o#!w#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~##Oom~[~Op#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P!Gh!Q![!Le![!]!*e!]!a%a!a!b!Ip!b!c#r!c!}!Gh#O#P!Ip#Q#R%a#R#S!Gh#S#T#r#T#o!Gh#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~#%WW!n~[~!O!P!Ip!Q![!Ip!a!b!Ip!c!}!Ip#O#P!Ip#R#S!Ip#T#o!Ip$Lv$Lw!Ipf#%uZ!cbOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a]#&mZ!iXOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#'eZ!lROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a",tokenizers:[es,eg,em,0,1,2,3,4],topRules:{Script:[0,6]},specialized:[{term:76,get:(e,t)=>eO(e,t)<<1,external:eO},{term:29,get:(e,t)=>ey(e,t)<<1|1,external:ey,extend:!0},{term:77,get:(e,t)=>ev(e,t)<<1,external:ev},{term:12,get:(e,t)=>eS(e,t)<<1,external:eS}],tokenPrec:1353});var ew=e.i(42297),ex=e.i(474754),eE=e.i(868275);let eC=a.StateEffect.define(),eP={"en-US":()=>e.A(163894)};async function ek(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en-US",r=null!=(e=eP[t])?e:eP["en-US"];return r?(await r()).default.formulas:{}}async function eQ(e,t){let r=(0,p.syntaxTree)(e).resolveInner(t).enterUnfinishedNodesBefore(t);if("ArgList"!==r.name||!r.parent)return null;let n=r.parent.getChild("BuiltInFunctionName")||r.parent.getChild("FunctionName");if(!n)return null;let o=await eA(n,e.doc);if(!o)return null;let a=0;for(let e=t;;){let t=r.childBefore(e);if(!t)break;t.type.is("Separator")&&a++,e=t.from}return()=>(function(e,t){let r=document.createElement("div");for(let n of(r.className="cm-argumentHints",[e.parameters.map(eR)])){let o=document.createElement("span");for(let e=0;e<n.length;e++){let r=n[e];if(void 0!==r){if(e===t||e<t&&r.startsWith("...")){let e=document.createElement("span");e.className="cm-activeArg",o.appendChild(e).appendChild(document.createTextNode(r))}else o.appendChild(document.createTextNode(r));e<n.length-1&&o.appendChild(document.createTextNode(", "))}}let a=r.appendChild(document.createElement("div"));a.className="source-code",a.appendChild(document.createTextNode(e.id)),a.appendChild(document.createTextNode("(")),a.appendChild(o),a.appendChild(document.createTextNode(")"))}let n=r.appendChild(document.createElement("div"));return n.className="cm-description",n.appendChild(document.createTextNode(e.description||"")),n.append(),{dom:r}})(o,a)}let eR=e=>(e.repeating?"...".concat(e.name):e.optional?"[".concat(e.name,"]"):e.name)+(e.type?": ".concat(e.type):"");async function eA(e,t){var r;let n=t.sliceString(e.from,e.to);return null!=(r=(await ek("en-US"))[n])?r:null}var eT=e.i(728243),eN=e.i(701856);function eW(e){let t=[];return(0,p.syntaxTree)(e).iterate({enter:r=>{if("Reference"===r.name){let n=e.doc.sliceString(r.from,r.to),o=(0,eN.addressToRange)(n);return void 0===o||(t.push({from:r.from,to:r.to,selection:new f.CellSelection(o.anchor,o.head)}),!1)}}}),t}let eq=a.StateField.define({create:e=>eW(e),update:(e,t)=>t.docChanged?eW(t.state):e,provide:e=>eT.cellReferencesFacet.from(e)});var eI=e.i(874838);let eM=eb.configure({props:[p.indentNodeProp.add({Application:(0,p.delimitedIndent)({closing:")",align:!1})}),p.foldNodeProp.add({Application:p.foldInside}),(0,h.styleTags)({"Reference/...":h.tags.color,"RangeToken!":h.tags.tagName,CellToken:h.tags.tagName,ColRangeToken:h.tags.tagName,RowRangeToken:h.tags.tagName,RefErrorToken:h.tags.invalid,BoolToken:h.tags.bool,ErrorToken:h.tags.invalid,NumberToken:h.tags.number,TextToken:h.tags.string,FunctionName:h.tags.function(h.tags.name),BuiltInFunctionName:h.tags.function(h.tags.name),"( )":h.tags.paren,"[ ]":h.tags.squareBracket,"{ }":h.tags.brace})]});function eX(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return/^[=+-]/.test(e)?[function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=function(e){let{locale:t="en-US",decimalSeparator:r="."}=e;return p.LRLanguage.define({name:"spreadsheet",parser:eM.configure({tokenizers:[{from:r,to:eu(r)},{from:eg,to:ef(r)},{from:eO,to:eh(r)}]}),languageData:{autocomplete:async function(e){let r=Object.values(await ek(t));if(!r)return null;let n=(0,p.syntaxTree)(e.state).resolveInner(e.pos,-1);if("FunctionName"!==n.name&&"BuiltInFunctionName"!==n.name&&"NameToken"!==n.name)return null;let o=e.matchBefore(/\w*/);return(!o||o.from!=o.to||e.explicit)&&o?{from:o.from,options:r.map(e=>(0,eI.snippetCompletion)("".concat(e.id,"(#{1})"),{label:e.id,type:"function",apply:"".concat(e.id),info:e.description}))}:null}}})}(t),n=null!=(e=t.readOnly)&&e;return new p.LanguageSupport(r,[u.monoFontFamily,eq,eT.cellHighlights,...n?[]:[function(e){var t,r;let n=a.StateEffect.define();return[a.StateField.define({create:()=>null,update(e,t){if(t.selection&&(e=null),e&&!t.changes.empty){let r=t.changes.mapPos(e.pos,-1,a.MapMode.TrackDel);e=null===r?null:{pos:r,create:e.create,above:!0}}for(let r of t.effects)r.is(n)?e={pos:t.state.selection.main.from,create:r.value,above:!0}:r.is(eC)&&(e=null);return e},provide:e=>i.showTooltip.from(e)}),i.ViewPlugin.fromClass((t=new WeakSet,r=new WeakSet,class{update(e){this.updateID++,e.transactions.some(e=>e.selection)&&e.state.selection.main.empty&&(0,ew._)(this,t,o).call(this,e.view)}constructor(){(0,ex._)(this,t),(0,ex._)(this,r),(0,eE._)(this,"pending",-1),(0,eE._)(this,"updateID",0)}}))];function o(e){this.pending>-1&&clearTimeout(this.pending),this.pending=window.setTimeout(()=>(0,ew._)(this,r,l).call(this,e),50)}function l(r){this.pending=-1;let{main:a}=r.state.selection;if(a.empty){let{updateID:i}=this;e(r.state,a.from).then(e=>{this.updateID!==i?this.pending<0&&(0,ew._)(this,t,o).call(this,r):e?r.dispatch({effects:n.of(e)}):r.dispatch({effects:eC.of(null)})})}}}(eQ)]])}({readOnly:t}),(0,f.cellMode)()]:[]}var eD=e.i(517166);let ej=i.EditorView.theme({"& .cm-scroller":{fontFamily:"var(--cm-mono-font, inherit)"},"&":{backgroundColor:"var(--gdg-bg-cell)",color:"var(--gdg-text-dark)"},"& .cm-cursor, & .cm-dropCursor":{borderLeftColor:"var(--gdg-text-dark)"},"&.cm-focused":{outline:"none"},"&.cm-focused .cm-selectionBackground, ::selection":{backgroundColor:"color-mix(in srgb, var(--gdg-accent-color), transparent 66%) !important"},"& .cm-line":{padding:"0 1px"},".cm-tooltip":{backgroundColor:"var(--gdg-bg-cell)",color:"var(--gdg-text-dark)",border:"0px solid var(--gdg-border-color)",boxShadow:"0 0 0 1px var(--gdg-border-color)",borderRadius:"2px",textAlign:"initial"},".cm-tooltip.cm-tooltip-autocomplete":{padding:"0"},".cm-tooltip.cm-tooltip-autocomplete .cm-completionDetail":{color:"var(--gdg-text-header)",fontStyle:"normal"},".cm-tooltip.cm-tooltip-autocomplete > ul":{fontFamily:"var(--cm-mono-font, inherit)"},".cm-completionIcon":{paddingRight:"0.125rem"},".cm-completionMatchedText":{textDecoration:"initial"},".cm-tooltip.cm-tooltip-autocomplete > ul > li":{padding:"0.25rem 0.50rem"},".cm-tooltip.cm-tooltip-autocomplete > ul > li[aria-selected]":{backgroundColor:"color-mix(in srgb, var(--gdg-accent-color), transparent 66%) !important",color:"var(--gdg-text-dark)"},".cm-argumentHints":{display:"flex",flexDirection:"column",padding:"0.25rem 0.50rem",pointerEvents:"none",whiteSpace:"nowrap",lineHeight:"20px",marginBottom:"4px",width:"fit-content"},".cm-argumentHints .source-code":{fontFamily:"var(--cm-mono-font, inherit)",textWrap:"nowrap"},".cm-argumentHints .cm-activeArg":{backgroundColor:"color-mix(in srgb, var(--gdg-accent-color), transparent 66%) !important"},".cm-description":{color:"var(--gdg-text-header)",textWrap:"pretty"},".cm-tooltip.cm-completionInfo":{color:"var(--gdg-text-header)"},".cm-tooltip.cm-completionInfo.cm-completionInfo-right, .cm-tooltip.cm-completionInfo.cm-completionInfo-left":{margin:"0px 1px"},".cm-cell-range-marker":{color:"var(--gdg-text-light)"},".cm-underline .cm-cell-reference":{textDecoration:"underline"}}),eB=l.default.memo(function(e){let{className:t="",editable:r=!0,readOnly:f=!1,selectAllAtStart:p=!1,autoFocus:h=!1,initialValue:m="",placeholder:g="Empty",onChange:O=()=>null,onHighlightRegions:v=()=>{},cell:S}=e,y=(0,c.useSpreadsheet)(!1),b=l.default.useRef(null),w=l.default.useRef(null);return l.default.useEffect(()=>{if(!w.current)return;let e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.state.facet(eT.cellHighlightsFacet);(e.hasFocus||!(t.length>0))&&(null==v||v(t.map(e=>{let{color:t,range:r}=e;return{color:t+"40",range:r}})))},t=i.EditorView.updateListener.of(t=>{t.docChanged&&(O(t.state.doc.toString()),e(t.view))}),n=new i.EditorView({state:a.EditorState.create({doc:m,extensions:[ej,t,u.basicSetup,u.singleLineSetup,(0,i.placeholder)(g),a.Prec.low(u.sansFontFamily),a.EditorState.readOnly.of(f),i.EditorView.editable.of(r),i.EditorView.contentAttributes.of({tabindex:"0"}),function(e){let{initialDoc:t="",readOnly:r=!1}=e,n=new a.Compartment;return[n.of(eX(t,r)),a.EditorState.transactionExtender.of(e=>{if(!e.docChanged||!e.changes.touchesRange(0))return null;let t=e.state.facet(a.EditorState.readOnly)&&!e.state.facet(i.EditorView.editable);return{effects:n.reconfigure(eX(e.newDoc.sliceString(0,1),t))}})]}({initialDoc:m,readOnly:f}),eD.sheetStateCompartment.of(eD.spreadsheetState.of({...eD.DEFAULT_SPREADSHEET_STATE})),eD.sheetViewCompartment.of(eD.spreadsheetView.of({cellFromPointer:e=>{var t,r;let n=null==(r=e.target)||null==(t=r.closest("[data-sheet-id]"))?void 0:t.dataset.sheetId;if(!n)return;let o=null==y?void 0:y.gridRefs[Number(n)],a=null==o?void 0:o.getMouseArgsForPosition(e.clientX,e.clientY,e);if(!a||"cell"!=a.kind&&"header"!=a.kind)return;let[i,l]=a.location;return{col:i,row:l,sheet:Number(n)}},scrollToCell:e=>{let t=null==y?void 0:y.gridRefs[e.sheet];null==t||t.scrollTo(e.col,e.row)}})),eT.cellHighlights,i.EditorView.domEventHandlers({focus(t,r){e(r)},blur(t,r){e(r,[])}})]}),parent:w.current});h&&n.focus(),p?(0,o.selectAll)(n):(0,o.cursorDocEnd)(n),(0,eD.updateSpreadsheetState)({cell:S})(n);let l=e=>(0,d.handlePointerDown)(e,n),s=n.win;return s.addEventListener("pointerdown",l,!0),b.current=n,y&&(y.editor=n),()=>{n.destroy(),b.current=null,s.removeEventListener("pointerdown",l,!0),y&&y.editor===n&&(y.editor=void 0)}},[]),l.default.useEffect(function(){b.current&&(0,eD.updateSpreadsheetState)({cell:S})(b.current)},[S]),(0,n.jsx)("div",{className:(0,s.cn)("data-grid-editor",t),ref:w,style:{margin:"auto 0"},id:"formula-editor"})});function ez(e){let{initialValue:t="",onSubmit:r,onCancel:o,...a}=e,[i,s]=l.default.useState(t),c=l.default.useCallback(e=>{let t=[0,0],n=!1;switch(e.key){case"Escape":e.preventDefault(),e.stopPropagation(),t=[0,0];break;case"Enter":e.preventDefault(),e.stopPropagation(),t=[0,e.shiftKey?-1:1],n=!0;break;case"Tab":e.preventDefault(),e.stopPropagation(),t=[e.shiftKey?-1:1,0],n=!0;break;default:return}n?r(i,t):o()},[i,r,o]);return(0,n.jsx)("div",{className:"contents",onKeyDown:c,style:{"--gdg-bg-cell":"var(--surface-l1)","--gdg-text-dark":"hsl(var(--fg-primary))","--gdg-text-header":"hsl(var(--fg-primary))","--gdg-border-color":"var(--border-l1)","--gdg-accent-color":"#0ea5e9"},children:(0,n.jsx)(eB,{...a,onChange:s,initialValue:t})})}let e_=l.default.memo(function(e){let{onFinishedEditing:t,value:r,isHighlighted:o}=e,a=(0,c.useSpreadsheet)(),i=a.editingCell,s=l.default.useRef(r);s.current=r;let u=l.default.useCallback((e,r)=>t({...s.current,data:e},r),[t]);return i?(0,n.jsx)(ez,{editable:!0!==r.readonly,readOnly:!0===r.readonly,autoFocus:!0,selectAllAtStart:o&&!1,initialValue:r.data,cell:i,onSubmit:u,onCancel:()=>t(void 0),onHighlightRegions:e=>a.setNodeProps({highlights:e})}):null}),eV=e=>({editor:e_,styleOverride:{textAlign:e.contentAlign,padding:"0 calc(var(--gdg-cell-horizontal-padding) - 0.5px)",display:"flex",justifyItems:"center"},disablePadding:!0}),eF=eV}]);
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="50041985-e7b4-5617-ab98-76540d9a8326")}catch(e){}}();
//# debugId=50041985-e7b4-5617-ab98-76540d9a8326
